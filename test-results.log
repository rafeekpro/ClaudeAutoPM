
> claude-autopm@1.5.29 test:all
> npm run test:security && npm run test:regression && npm run test:install && npm run test:cli && npm run test:node && npm run test:migration && npm run test:commands


> claude-autopm@1.5.29 test:security
> node test/run-security-tests.js

ðŸ”’ Running Hybrid Strategy Security Tests


ðŸ“‹ Running: Core Security Tests
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAP version 13
# Subtest: Hybrid Strategy Security Tests
    # Subtest: Prompt Injection Prevention
        # Subtest: should detect direct injection attempts
        ok 1 - should detect direct injection attempts
          ---
          duration_ms: 1.39275
          type: 'test'
          ...
        # Subtest: should allow legitimate prompts
        ok 2 - should allow legitimate prompts
          ---
          duration_ms: 1.9215
          type: 'test'
          ...
        # Subtest: should sanitize user inputs
        ok 3 - should sanitize user inputs
          ---
          duration_ms: 2.0525
          type: 'test'
          ...
        1..3
    ok 1 - Prompt Injection Prevention
      ---
      duration_ms: 5.695792
      type: 'suite'
      ...
    # Subtest: Context Isolation
        # Subtest: should maintain context isolation between agents
        ok 1 - should maintain context isolation between agents
          ---
          duration_ms: 2.0505
          type: 'test'
          ...
        # Subtest: should validate context boundaries
        ok 2 - should validate context boundaries
          ---
          duration_ms: 2.026041
          type: 'test'
          ...
        1..2
    ok 2 - Context Isolation
      ---
      duration_ms: 4.232083
      type: 'suite'
      ...
    # Subtest: Resource Limits
        # Subtest: should enforce rate limiting
        ok 1 - should enforce rate limiting
          ---
          duration_ms: 1.751375
          type: 'test'
          ...
        # Subtest: should prevent resource exhaustion
        ok 2 - should prevent resource exhaustion
          ---
          duration_ms: 1.986792
          type: 'test'
          ...
        1..2
    ok 3 - Resource Limits
      ---
      duration_ms: 3.806666
      type: 'suite'
      ...
    # Subtest: Parallel Execution Safety
        # Subtest: should limit parallel contexts
        ok 1 - should limit parallel contexts
          ---
          duration_ms: 0.974125
          type: 'test'
          ...
        # Subtest: should handle race conditions
        ok 2 - should handle race conditions
          ---
          duration_ms: 10.900667
          type: 'test'
          ...
        1..2
    ok 4 - Parallel Execution Safety
      ---
      duration_ms: 11.933917
      type: 'suite'
      ...
    1..4
ok 1 - Hybrid Strategy Security Tests
  ---
  duration_ms: 26.0275
  type: 'suite'
  ...
1..1
# tests 9
# suites 5
# pass 9
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 61.922167
âœ… Core Security Tests: PASSED

ðŸ“‹ Running: Prompt Injection Prevention
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAP version 13
# Subtest: Prompt Injection Security Tests
    # Subtest: Direct Injection Attempts
        # Subtest: should detect instruction override attempts
        ok 1 - should detect instruction override attempts
          ---
          duration_ms: 2.671625
          type: 'test'
          ...
        # Subtest: should detect role manipulation
        ok 2 - should detect role manipulation
          ---
          duration_ms: 0.206167
          type: 'test'
          ...
        1..2
    ok 1 - Direct Injection Attempts
      ---
      duration_ms: 3.291333
      type: 'suite'
      ...
    # Subtest: Code Injection Detection
        # Subtest: should detect JavaScript injection attempts
        ok 1 - should detect JavaScript injection attempts
          ---
          duration_ms: 0.64625
          type: 'test'
          ...
        # Subtest: should detect Python injection attempts
        ok 2 - should detect Python injection attempts
          ---
          duration_ms: 0.468083
          type: 'test'
          ...
        1..2
    ok 2 - Code Injection Detection
      ---
      duration_ms: 1.185625
      type: 'suite'
      ...
    # Subtest: XSS and HTML Injection
        # Subtest: should detect XSS attempts
        ok 1 - should detect XSS attempts
          ---
          duration_ms: 0.214292
          type: 'test'
          ...
        1..1
    ok 3 - XSS and HTML Injection
      ---
      duration_ms: 0.24325
      type: 'suite'
      ...
    # Subtest: Path Traversal
        # Subtest: should detect path traversal attempts
        ok 1 - should detect path traversal attempts
          ---
          duration_ms: 0.41725
          type: 'test'
          ...
        1..1
    ok 4 - Path Traversal
      ---
      duration_ms: 0.509708
      type: 'suite'
      ...
    # Subtest: SQL Injection
        # Subtest: should detect SQL injection attempts
        ok 1 - should detect SQL injection attempts
          ---
          duration_ms: 0.110667
          type: 'test'
          ...
        1..1
    ok 5 - SQL Injection
      ---
      duration_ms: 0.142375
      type: 'suite'
      ...
    # Subtest: Anomaly Detection
        # Subtest: should detect length anomalies
        ok 1 - should detect length anomalies
          ---
          duration_ms: 0.88
          type: 'test'
          ...
        # Subtest: should detect repetition patterns
        ok 2 - should detect repetition patterns
          ---
          duration_ms: 0.239708
          type: 'test'
          ...
        # Subtest: should detect excessive nesting
        ok 3 - should detect excessive nesting
          ---
          duration_ms: 0.149
          type: 'test'
          ...
        1..3
    ok 6 - Anomaly Detection
      ---
      duration_ms: 1.338125
      type: 'suite'
      ...
    # Subtest: Safe Prompts
        # Subtest: should allow legitimate prompts
        ok 1 - should allow legitimate prompts
          ---
          duration_ms: 0.382583
          type: 'test'
          ...
        1..1
    ok 7 - Safe Prompts
      ---
      duration_ms: 0.413875
      type: 'suite'
      ...
    1..7
ok 1 - Prompt Injection Security Tests
  ---
  duration_ms: 7.568458
  type: 'suite'
  ...
1..1
# tests 11
# suites 8
# pass 11
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 45.302291
âœ… Prompt Injection Prevention: PASSED

ðŸ“‹ Running: Integration & Isolation Tests
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAP version 13
# Subtest: Hybrid Strategy Integration Tests
    # Subtest: Context Lifecycle Management
        # Subtest: should create and terminate contexts properly
        ok 1 - should create and terminate contexts properly
          ---
          duration_ms: 0.619833
          type: 'test'
          ...
        # Subtest: should prevent duplicate context creation
        ok 2 - should prevent duplicate context creation
          ---
          duration_ms: 0.328375
          type: 'test'
          ...
        # Subtest: should enforce context timeout
        ok 3 - should enforce context timeout
          ---
          duration_ms: 151.850417
          type: 'test'
          ...
        1..3
    ok 1 - Context Lifecycle Management
      ---
      duration_ms: 153.439417
      type: 'suite'
      ...
    # Subtest: Security Validation
        # Subtest: should block dangerous operations
        ok 1 - should block dangerous operations
          ---
          duration_ms: 0.640875
          type: 'test'
          ...
        # Subtest: should allow safe operations
        ok 2 - should allow safe operations
          ---
          duration_ms: 0.5135
          type: 'test'
          ...
        1..2
    ok 2 - Security Validation
      ---
      duration_ms: 1.256
      type: 'suite'
      ...
    # Subtest: Resource Limits
        # Subtest: should enforce token limits
        ok 1 - should enforce token limits
          ---
          duration_ms: 0.330167
          type: 'test'
          ...
        # Subtest: should enforce depth limits
        ok 2 - should enforce depth limits
          ---
          duration_ms: 0.670041
          type: 'test'
          ...
        1..2
    ok 3 - Resource Limits
      ---
      duration_ms: 1.211917
      type: 'suite'
      ...
    # Subtest: Parallel Agent Management
        # Subtest: should limit parallel agents
        ok 1 - should limit parallel agents
          ---
          duration_ms: 1.201709
          type: 'test'
          ...
        # Subtest: should isolate agent contexts
        ok 2 - should isolate agent contexts
          ---
          duration_ms: 0.581833
          type: 'test'
          ...
        1..2
    ok 4 - Parallel Agent Management
      ---
      duration_ms: 1.86725
      type: 'suite'
      ...
    # Subtest: Context Isolation
        # Subtest: should maintain isolation between contexts
        ok 1 - should maintain isolation between contexts
          ---
          duration_ms: 0.256792
          type: 'test'
          ...
        # Subtest: should detect isolation violations
        ok 2 - should detect isolation violations
          ---
          duration_ms: 0.142125
          type: 'test'
          ...
        1..2
    ok 5 - Context Isolation
      ---
      duration_ms: 0.466
      type: 'suite'
      ...
    # Subtest: Error Recovery
        # Subtest: should handle context failures gracefully
        ok 1 - should handle context failures gracefully
          ---
          duration_ms: 0.159583
          type: 'test'
          ...
        # Subtest: should cleanup terminated contexts
        ok 2 - should cleanup terminated contexts
          ---
          duration_ms: 0.0915
          type: 'test'
          ...
        1..2
    ok 6 - Error Recovery
      ---
      duration_ms: 0.290208
      type: 'suite'
      ...
    1..6
ok 1 - Hybrid Strategy Integration Tests
  ---
  duration_ms: 159.631417
  type: 'suite'
  ...
1..1
# tests 13
# suites 7
# pass 13
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 202.810917
âœ… Integration & Isolation Tests: PASSED

ðŸ“‹ Running: Performance & Resource Limits
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAP version 13
# Subtest: Performance and Resource Limit Tests
    # Subtest: Performance Monitoring
        # Subtest: should measure execution time accurately
        ok 1 - should measure execution time accurately
          ---
          duration_ms: 102.595709
          type: 'test'
          ...
        # Subtest: should track memory usage
        ok 2 - should track memory usage
          ---
          duration_ms: 1.936708
          type: 'test'
          ...
        1..2
    ok 1 - Performance Monitoring
      ---
      duration_ms: 105.07525
      type: 'suite'
      ...
    # Subtest: Load Testing
        # Subtest: should handle concurrent requests
        ok 1 - should handle concurrent requests
          ---
          duration_ms: 222.414
          type: 'test'
          ...
        # Subtest: should calculate performance percentiles
        ok 2 - should calculate performance percentiles
          ---
          duration_ms: 1638.991917
          type: 'test'
          ...
        1..2
    ok 2 - Load Testing
      ---
      duration_ms: 1861.895208
      type: 'suite'
      ...
    # Subtest: Resource Limiting
        # Subtest: should enforce memory limits
        ok 1 - should enforce memory limits
          ---
          duration_ms: 0.651167
          type: 'test'
          ...
        # Subtest: should track multiple resources
        ok 2 - should track multiple resources
          ---
          duration_ms: 0.150458
          type: 'test'
          ...
        # Subtest: should release resources
        ok 3 - should release resources
          ---
          duration_ms: 0.208709
          type: 'test'
          ...
        # Subtest: should check limits without consuming
        ok 4 - should check limits without consuming
          ---
          duration_ms: 0.097458
          type: 'test'
          ...
        1..4
    ok 3 - Resource Limiting
      ---
      duration_ms: 1.345375
      type: 'suite'
      ...
    # Subtest: Rate Limiting
        # Subtest: should implement token bucket algorithm
        ok 1 - should implement token bucket algorithm
          ---
          duration_ms: 1002.295792
          type: 'test'
          ...
        # Subtest: should refill tokens over time
        ok 2 - should refill tokens over time
          ---
          duration_ms: 502.584125
          type: 'test'
          ...
        1..2
    ok 4 - Rate Limiting
      ---
      duration_ms: 1505.437042
      type: 'suite'
      ...
    # Subtest: Stress Testing
        # Subtest: should handle burst traffic
        ok 1 - should handle burst traffic
          ---
          duration_ms: 1.272166
          type: 'test'
          ...
        # Subtest: should detect memory leaks
        ok 2 - should detect memory leaks
          ---
          duration_ms: 3.308875
          type: 'test'
          ...
        # Subtest: should handle timeout scenarios
        ok 3 - should handle timeout scenarios
          ---
          duration_ms: 101.940458
          type: 'test'
          ...
        1..3
    ok 5 - Stress Testing
      ---
      duration_ms: 106.943875
      type: 'suite'
      ...
    # Subtest: Resource Exhaustion Prevention
        # Subtest: should prevent infinite loops
        ok 1 - should prevent infinite loops
          ---
          duration_ms: 1.039292
          type: 'test'
          ...
        # Subtest: should limit recursive depth
        ok 2 - should limit recursive depth
          ---
          duration_ms: 0.31575
          type: 'test'
          ...
        # Subtest: should enforce payload size limits
        ok 3 - should enforce payload size limits
          ---
          duration_ms: 13.1645
          type: 'test'
          ...
        1..3
    ok 6 - Resource Exhaustion Prevention
      ---
      duration_ms: 14.718625
      type: 'suite'
      ...
    1..6
ok 1 - Performance and Resource Limit Tests
  ---
  duration_ms: 3596.483084
  type: 'suite'
  ...
1..1
# tests 16
# suites 7
# pass 16
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 3722.898792
âœ… Performance & Resource Limits: PASSED

==================================================
ðŸ“Š Test Summary:
==================================================
âœ… PASS - Core Security Tests
âœ… PASS - Prompt Injection Prevention
âœ… PASS - Integration & Isolation Tests
âœ… PASS - Performance & Resource Limits
==================================================

ðŸŽ‰ All security tests passed!
âœ¨ The Hybrid Strategy implementation is secure.


> claude-autopm@1.5.29 test:regression
> node --test --test-concurrency=1 test/regression/*.test.js

TAP version 13
# ðŸ“Š System Health Report:
#    Overall Health: 87.5%
#    Valid Files: 3/4
#    Valid Features: 4/4
# ðŸ“„ Health report saved to: /Users/rla/Projects/AUTOPM/test/regression/__snapshots__/health-report.json
# Subtest: Critical Path Protection
    # Subtest: Essential Files
        # Subtest: should have all required files present
        ok 1 - should have all required files present
          ---
          duration_ms: 0.332125
          type: 'test'
          ...
        # Subtest: should maintain HYBRID_STRATEGY.md integrity
        ok 2 - should maintain HYBRID_STRATEGY.md integrity
          ---
          duration_ms: 0.048208
          type: 'test'
          ...
        # Subtest: should have valid package.json
        ok 3 - should have valid package.json
          ---
          duration_ms: 0.085667
          type: 'test'
          ...
        # Subtest: should maintain configuration files
        ok 4 - should maintain configuration files
          ---
          duration_ms: 0.036916
          type: 'test'
          ...
        1..4
    ok 1 - Essential Files
      ---
      duration_ms: 0.730375
      type: 'suite'
      ...
    # Subtest: Core Features
        # Subtest: should preserve parallel execution capability
        ok 1 - should preserve parallel execution capability
          ---
          duration_ms: 0.135
          type: 'test'
          ...
        # Subtest: should maintain context isolation
        ok 2 - should maintain context isolation
          ---
          duration_ms: 0.044333
          type: 'test'
          ...
        # Subtest: should enforce resource limits
        ok 3 - should enforce resource limits
          ---
          duration_ms: 0.108125
          type: 'test'
          ...
        # Subtest: should have error recovery mechanisms
        ok 4 - should have error recovery mechanisms
          ---
          duration_ms: 0.106084
          type: 'test'
          ...
        1..4
    ok 2 - Core Features
      ---
      duration_ms: 0.694625
      type: 'suite'
      ...
    # Subtest: Health Check
        # Subtest: should maintain overall system health above 80%
        ok 1 - should maintain overall system health above 80%
          ---
          duration_ms: 0.39775
          type: 'test'
          ...
        # Subtest: should generate actionable report
        ok 2 - should generate actionable report
          ---
          duration_ms: 0.254667
          type: 'test'
          ...
        1..2
    ok 3 - Health Check
      ---
      duration_ms: 0.700791
      type: 'suite'
      ...
    1..3
ok 1 - Critical Path Protection
  ---
  duration_ms: 4.318542
  type: 'suite'
  ...
# âœ… Fully synchronous regression tests completed
# ðŸ“„ Tests optimized for Node.js v22.19.0 test runner compatibility
# â„¹ï¸  File validated successfully
# â„¹ï¸  Strategy file validation simplified for Node.js compatibility
# âš ï¸  Environment warnings: [
#   'Optional env var not set: CLAUDE_PARALLEL_ENABLED',
#   'Optional env var not set: CLAUDE_MAX_AGENTS',
#   'Optional env var not set: CLAUDE_CONTEXT_ISOLATION'
# ]
# â„¹ï¸  Orchestrator not found - skipping
# â„¹ï¸  Prompts directory not found
# Subtest: ACTIVE_STRATEGY Regression Tests
    # Subtest: File Structure Integrity
        # Subtest: should maintain critical file structure
        ok 1 - should maintain critical file structure
          ---
          duration_ms: 0.359583
          type: 'test'
          ...
        # Subtest: should detect file modifications
        ok 2 - should detect file modifications
          ---
          duration_ms: 0.164417
          type: 'test'
          ...
        1..2
    ok 1 - File Structure Integrity
      ---
      duration_ms: 1.214875
      type: 'suite'
      ...
    # Subtest: Core Functionality Preservation
        # Subtest: should preserve context management patterns
        ok 1 - should preserve context management patterns
          ---
          duration_ms: 0.105959
          type: 'test'
          ...
        # Subtest: should maintain parallel execution capabilities
        ok 2 - should maintain parallel execution capabilities
          ---
          duration_ms: 0.067333
          type: 'test'
          ...
        # Subtest: should preserve resource management
        ok 3 - should preserve resource management
          ---
          duration_ms: 0.053666
          type: 'test'
          ...
        1..3
    ok 2 - Core Functionality Preservation
      ---
      duration_ms: 0.399125
      type: 'suite'
      ...
    # Subtest: Backward Compatibility
        # Subtest: should maintain v1 API compatibility
        ok 1 - should maintain v1 API compatibility
          ---
          duration_ms: 0.0665
          type: 'test'
          ...
        # Subtest: should support v2 features
        ok 2 - should support v2 features
          ---
          duration_ms: 0.189792
          type: 'test'
          ...
        # Subtest: should provide safe migration paths
        ok 3 - should provide safe migration paths
          ---
          duration_ms: 0.041625
          type: 'test'
          ...
        1..3
    ok 3 - Backward Compatibility
      ---
      duration_ms: 0.516708
      type: 'suite'
      ...
    # Subtest: Configuration Stability
        # Subtest: should preserve default configurations
        ok 1 - should preserve default configurations
          ---
          duration_ms: 0.120209
          type: 'test'
          ...
        # Subtest: should validate environment variables
        ok 2 - should validate environment variables
          ---
          duration_ms: 0.278292
          type: 'test'
          ...
        1..2
    ok 4 - Configuration Stability
      ---
      duration_ms: 0.469125
      type: 'suite'
      ...
    # Subtest: Integration Points
        # Subtest: should maintain compatibility with orchestrator
        ok 1 - should maintain compatibility with orchestrator
          ---
          duration_ms: 0.086042
          type: 'test'
          ...
        # Subtest: should preserve prompt templates
        ok 2 - should preserve prompt templates
          ---
          duration_ms: 0.07625
          type: 'test'
          ...
        1..2
    ok 5 - Integration Points
      ---
      duration_ms: 0.194417
      type: 'suite'
      ...
    1..5
ok 2 - ACTIVE_STRATEGY Regression Tests
  ---
  duration_ms: 3.079291
  type: 'suite'
  ...
1..2
# tests 22
# suites 10
# pass 22
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 77.134458

> claude-autopm@1.5.29 test:install
> bash test/installation/integration.test.sh


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ClaudeAutoPM Integration Tests
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Testing Scenario 1: Minimal
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ Testing: Setting up test directory
âœ“ Test directory created
â–¶ Testing: Running installation
âœ“ Installation completed
â–¶ Testing: Verifying core files
âœ“ Minimal: .claude exists
âœ“ Minimal: .claude/agents exists
âœ“ Minimal: .claude/commands exists
âœ“ Minimal: .claude/rules exists
âœ“ Minimal: .claude/scripts exists
âœ“ Minimal: CLAUDE.md exists
âœ“ Minimal: scripts exists
âœ“ Minimal: scripts/safe-commit.sh exists
âœ“ Minimal: scripts/setup-hooks.sh exists
â–¶ Testing: Verifying scenario-specific files
âœ“ Minimal: Strategy file exists
âœ“ Minimal: Sequential strategy configured

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Testing Scenario 2: Docker-only
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ Testing: Setting up test directory
âœ“ Test directory created
â–¶ Testing: Running installation
âœ“ Installation completed
â–¶ Testing: Verifying core files
âœ“ Docker-only: .claude exists
âœ“ Docker-only: .claude/agents exists
âœ“ Docker-only: .claude/commands exists
âœ“ Docker-only: .claude/rules exists
âœ“ Docker-only: .claude/scripts exists
âœ“ Docker-only: CLAUDE.md exists
âœ“ Docker-only: scripts exists
âœ“ Docker-only: scripts/safe-commit.sh exists
âœ“ Docker-only: scripts/setup-hooks.sh exists
â–¶ Testing: Verifying scenario-specific files
âœ“ Docker-only: Strategy file exists

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Testing Scenario 3: Full DevOps
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ Testing: Setting up test directory
âœ“ Test directory created
â–¶ Testing: Running installation
âœ“ Installation completed
â–¶ Testing: Verifying core files
âœ“ Full DevOps: .claude exists
âœ“ Full DevOps: .claude/agents exists
âœ“ Full DevOps: .claude/commands exists
âœ“ Full DevOps: .claude/rules exists
âœ“ Full DevOps: .claude/scripts exists
âœ“ Full DevOps: CLAUDE.md exists
âœ“ Full DevOps: scripts exists
âœ“ Full DevOps: scripts/safe-commit.sh exists
âœ“ Full DevOps: scripts/setup-hooks.sh exists
â–¶ Testing: Verifying scenario-specific files
âœ“ Full DevOps: Strategy file exists

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Testing Scenario 4: Performance
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ Testing: Setting up test directory
âœ“ Test directory created
â–¶ Testing: Running installation
âœ“ Installation completed
â–¶ Testing: Verifying core files
âœ“ Performance: .claude exists
âœ“ Performance: .claude/agents exists
âœ“ Performance: .claude/commands exists
âœ“ Performance: .claude/rules exists
âœ“ Performance: .claude/scripts exists
âœ“ Performance: CLAUDE.md exists
âœ“ Performance: scripts exists
âœ“ Performance: scripts/safe-commit.sh exists
âœ“ Performance: scripts/setup-hooks.sh exists
â–¶ Testing: Verifying scenario-specific files
âœ“ Performance: Strategy file exists

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Test Summary
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Passed: 49 tests
Failed: 0 tests

Pass rate: 100%

âœ… All integration tests passed!

> claude-autopm@1.5.29 test:cli
> node --test test/cli/*.test.js

TAP version 13
# â­ï¸  Skipping old CLI API tests (commands have been migrated to yargs)
# Subtest: test/cli/autopm-commands.test.js
ok 1 - test/cli/autopm-commands.test.js
  ---
  duration_ms: 31.671416
  type: 'test'
  ...
# ðŸ§ª Running Basic CLI Tests...
# âœ“ Help command working
# âœ“ Version: 1.5.29
# âœ“ No arguments handling working
# âœ“ Invalid command handling working
# âœ“ pm:init command available
# Subtest: AutoPM CLI Basic Commands
    # Subtest: should show help with --help
    ok 1 - should show help with --help
      ---
      duration_ms: 127.320958
      type: 'test'
      ...
    # Subtest: should show version with --version
    ok 2 - should show version with --version
      ---
      duration_ms: 110.246041
      type: 'test'
      ...
    # Subtest: should show error with no arguments
    ok 3 - should show error with no arguments
      ---
      duration_ms: 112.953875
      type: 'test'
      ...
    # Subtest: should handle invalid commands gracefully
    ok 4 - should handle invalid commands gracefully
      ---
      duration_ms: 115.610875
      type: 'test'
      ...
    # Subtest: should handle pm:init command
    ok 5 - should handle pm:init command
      ---
      duration_ms: 147.980042
      type: 'test'
      ...
    1..5
ok 2 - AutoPM CLI Basic Commands
  ---
  duration_ms: 614.752416
  type: 'suite'
  ...
1..2
# tests 6
# suites 1
# pass 6
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 655.298375

> claude-autopm@1.5.29 test:node
> node --test test/node-scripts/**/*.test.js

TAP version 13
# Subtest: Install.js Migration Tests
    # Subtest: Prerequisites Check
        # Subtest: should verify Node.js version
        ok 1 - should verify Node.js version
          ---
          duration_ms: 235.340459
          type: 'test'
          ...
        # Subtest: should check for Git installation
        ok 2 - should check for Git installation
          ---
          duration_ms: 93.030584
          type: 'test'
          ...
        1..2
    ok 1 - Prerequisites Check
      ---
      duration_ms: 328.945459
      type: 'suite'
      ...
    # Subtest: Installation Type Detection
        # Subtest: should detect fresh installation
        ok 1 - should detect fresh installation
          ---
          duration_ms: 3.5565
          type: 'test'
          ...
        # Subtest: should detect existing installation
        ok 2 - should detect existing installation
          ---
          duration_ms: 3.355625
          type: 'test'
          ...
        1..2
    ok 2 - Installation Type Detection
      ---
      duration_ms: 7.198125
      type: 'suite'
      ...
    # Subtest: Configuration Management
        # Subtest: should use preset configuration
        ok 1 - should use preset configuration
          ---
          duration_ms: 3.131083
          type: 'test'
          ...
        # Subtest: should use default configuration in non-interactive mode
        ok 2 - should use default configuration in non-interactive mode
          ---
          duration_ms: 4.265042
          type: 'test'
          ...
        # Subtest: should validate DevOps preset
        ok 3 - should validate DevOps preset
          ---
          duration_ms: 2.63675
          type: 'test'
          ...
        1..3
    ok 3 - Configuration Management
      ---
      duration_ms: 10.420125
      type: 'suite'
      ...
    # Subtest: File Operations
        # Subtest: should copy framework files
        ok 1 - should copy framework files
          ---
          duration_ms: 9.557875
          type: 'test'
          ...
        # Subtest: should generate CLAUDE.md from template
        ok 2 - should generate CLAUDE.md from template
          ---
          duration_ms: 3.966042
          type: 'test'
          ...
        # Subtest: should update .gitignore
        ok 3 - should update .gitignore
          ---
          duration_ms: 3.904666
          type: 'test'
          ...
        1..3
    ok 4 - File Operations
      ---
      duration_ms: 17.60675
      type: 'suite'
      ...
    # Subtest: Backup and Rollback
        # Subtest: should create backup of existing installation
        ok 1 - should create backup of existing installation
          ---
          duration_ms: 5.211334
          type: 'test'
          ...
        # Subtest: should rollback on failure
        ok 2 - should rollback on failure
          ---
          duration_ms: 4.869833
          type: 'test'
          ...
        1..2
    ok 5 - Backup and Rollback
      ---
      duration_ms: 10.240125
      type: 'suite'
      ...
    # Subtest: Cross-Platform Compatibility
        # Subtest: should work on current platform
        ok 1 - should work on current platform
          ---
          duration_ms: 2.672458
          type: 'test'
          ...
        # Subtest: should handle paths correctly across platforms
        ok 2 - should handle paths correctly across platforms
          ---
          duration_ms: 2.824959
          type: 'test'
          ...
        1..2
    ok 6 - Cross-Platform Compatibility
      ---
      duration_ms: 5.600667
      type: 'suite'
      ...
    # Subtest: Non-Interactive Mode
        # Subtest: should complete installation without prompts
        ok 1 - should complete installation without prompts
          ---
          duration_ms: 7.520167
          type: 'test'
          ...
        1..1
    ok 7 - Non-Interactive Mode
      ---
      duration_ms: 7.602875
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should handle missing source files gracefully
        ok 1 - should handle missing source files gracefully
          ---
          duration_ms: 194.008041
          type: 'test'
          ...
        # Subtest: should validate configuration
        ok 2 - should validate configuration
          ---
          duration_ms: 2.904834
          type: 'test'
          ...
        1..2
    ok 8 - Error Handling
      ---
      duration_ms: 197.033417
      type: 'suite'
      ...
    1..8
ok 1 - Install.js Migration Tests
  ---
  duration_ms: 585.121917
  type: 'suite'
  ...
# Subtest: Merge-claude.js Migration Tests
    # Subtest: ClaudeMerger Initialization
        # Subtest: should create ClaudeMerger instance
        ok 1 - should create ClaudeMerger instance
          ---
          duration_ms: 3.985292
          type: 'test'
          ...
        # Subtest: should set correct paths
        ok 2 - should set correct paths
          ---
          duration_ms: 1.908875
          type: 'test'
          ...
        1..2
    ok 1 - ClaudeMerger Initialization
      ---
      duration_ms: 6.372458
      type: 'suite'
      ...
    # Subtest: File Discovery
        # Subtest: should find existing CLAUDE.md file
        ok 1 - should find existing CLAUDE.md file
          ---
          duration_ms: 5.796667
          type: 'test'
          ...
        # Subtest: should find CLAUDE.md in alternative locations
        ok 2 - should find CLAUDE.md in alternative locations
          ---
          duration_ms: 2.642334
          type: 'test'
          ...
        # Subtest: should return null when no CLAUDE.md found
        ok 3 - should return null when no CLAUDE.md found
          ---
          duration_ms: 0.983416
          type: 'test'
          ...
        # Subtest: should find framework file
        ok 4 - should find framework file
          ---
          duration_ms: 2.644
          type: 'test'
          ...
        # Subtest: should use specified files when provided
        ok 5 - should use specified files when provided
          ---
          duration_ms: 2.501958
          type: 'test'
          ...
        1..5
    ok 2 - File Discovery
      ---
      duration_ms: 15.146834
      type: 'suite'
      ...
    # Subtest: Merge Prompt Generation
        # Subtest: should generate merge prompt with both files
        ok 1 - should generate merge prompt with both files
          ---
          duration_ms: 5.526667
          type: 'test'
          ...
        # Subtest: should generate prompt with only existing file
        ok 2 - should generate prompt with only existing file
          ---
          duration_ms: 2.529333
          type: 'test'
          ...
        # Subtest: should include configuration in prompt
        ok 3 - should include configuration in prompt
          ---
          duration_ms: 3.547209
          type: 'test'
          ...
        1..3
    ok 3 - Merge Prompt Generation
      ---
      duration_ms: 12.053792
      type: 'suite'
      ...
    # Subtest: Output Handling
        # Subtest: should save prompt to file when output specified
        ok 1 - should save prompt to file when output specified
          ---
          duration_ms: 8.854167
          type: 'test'
          ...
        1..1
    ok 4 - Output Handling
      ---
      duration_ms: 9.237791
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should handle missing files gracefully
        ok 1 - should handle missing files gracefully
          ---
          duration_ms: 1.942041
          type: 'test'
          ...
        # Subtest: should handle empty directory
        ok 2 - should handle empty directory
          ---
          duration_ms: 4.075875
          type: 'test'
          ...
        1..2
    ok 5 - Error Handling
      ---
      duration_ms: 6.147125
      type: 'suite'
      ...
    1..5
ok 2 - Merge-claude.js Migration Tests
  ---
  duration_ms: 49.5995
  type: 'suite'
  ...
# Subtest: Setup-env.js Migration Tests
    # Subtest: EnvSetup Initialization
        # Subtest: should create EnvSetup instance
        ok 1 - should create EnvSetup instance
          ---
          duration_ms: 8.309417
          type: 'test'
          ...
        # Subtest: should set correct env path
        ok 2 - should set correct env path
          ---
          duration_ms: 5.56575
          type: 'test'
          ...
        1..2
    ok 1 - EnvSetup Initialization
      ---
      duration_ms: 14.3475
      type: 'suite'
      ...
    # Subtest: Environment File Operations
        # Subtest: should detect missing .env file
        ok 1 - should detect missing .env file
          ---
          duration_ms: 1.046167
          type: 'test'
          ...
        # Subtest: should create backup of existing .env
        ok 2 - should create backup of existing .env
          ---
          duration_ms: 9.134416
          type: 'test'
          ...
        # Subtest: should load existing environment variables
        ok 3 - should load existing environment variables
          ---
          duration_ms: 3.748292
          type: 'test'
          ...
        1..3
    ok 2 - Environment File Operations
      ---
      duration_ms: 15.1415
      type: 'suite'
      ...
    # Subtest: Token Validation
        # Subtest: should validate GitHub token formats
        ok 1 - should validate GitHub token formats
          ---
          duration_ms: 2.275875
          type: 'test'
          ...
        1..1
    ok 3 - Token Validation
      ---
      duration_ms: 2.467
      type: 'suite'
      ...
    # Subtest: Environment File Generation
        # Subtest: should generate properly formatted .env file
        ok 1 - should generate properly formatted .env file
          ---
          duration_ms: 11.320917
          type: 'test'
          ...
        # Subtest: should set secure permissions on .env file
        ok 2 - should set secure permissions on .env file
          ---
          duration_ms: 4.685708
          type: 'test'
          ...
        1..2
    ok 4 - Environment File Generation
      ---
      duration_ms: 16.38325
      type: 'suite'
      ...
    # Subtest: Non-Interactive Mode
        # Subtest: should complete without prompts in non-interactive mode
        ok 1 - should complete without prompts in non-interactive mode
          ---
          duration_ms: 3.219292
          type: 'test'
          ...
        1..1
    ok 5 - Non-Interactive Mode
      ---
      duration_ms: 3.333083
      type: 'suite'
      ...
    # Subtest: Configuration Summary
        # Subtest: should generate correct summary
        ok 1 - should generate correct summary
          ---
          duration_ms: 0.838042
          type: 'test'
          ...
        1..1
    ok 6 - Configuration Summary
      ---
      duration_ms: 0.899417
      type: 'suite'
      ...
    1..6
ok 3 - Setup-env.js Migration Tests
  ---
  duration_ms: 53.840917
  type: 'suite'
  ...
# Subtest: Utility Tests
    # Subtest: should load Logger
    ok 1 - should load Logger
      ---
      duration_ms: 0.983417
      type: 'test'
      ...
    # Subtest: should load FileSystem
    ok 2 - should load FileSystem
      ---
      duration_ms: 15.96025
      type: 'test'
      ...
    # Subtest: should load Shell
    ok 3 - should load Shell
      ---
      duration_ms: 11.522125
      type: 'test'
      ...
    # Subtest: should load Config
    ok 4 - should load Config
      ---
      duration_ms: 5.7605
      type: 'test'
      ...
    # Subtest: should load Prompts
    ok 5 - should load Prompts
      ---
      duration_ms: 123.33225
      type: 'test'
      ...
    # Subtest: should load Installer
    ok 6 - should load Installer
      ---
      duration_ms: 10.281625
      type: 'test'
      ...
    # Subtest: should get default config
    ok 7 - should get default config
      ---
      duration_ms: 0.1405
      type: 'test'
      ...
    1..7
ok 4 - Utility Tests
  ---
  duration_ms: 169.088542
  type: 'suite'
  ...
# Running AutoPM TDD tests...
# These tests are expected to FAIL initially (RED phase)
# Implement bin/node/autopm.js to make them pass (GREEN phase)
# Subtest: AutoPM CLI Migration Tests
    # Subtest: Command Routing
        # Subtest: should display help when no arguments provided
        ok 1 - should display help when no arguments provided
          ---
          duration_ms: 61.170167
          type: 'test'
          ...
        # Subtest: should handle --version flag
        ok 2 - should handle --version flag
          ---
          duration_ms: 74.335375
          type: 'test'
          ...
        # Subtest: should route install command to install.js
        ok 3 - should route install command to install.js
          ---
          duration_ms: 395.90125
          type: 'test'
          ...
        # Subtest: should route setup-env command to setup-env.js
        ok 4 - should route setup-env command to setup-env.js
          ---
          duration_ms: 336.09375
          type: 'test'
          ...
        # Subtest: should route merge-claude command to merge-claude.js
        ok 5 - should route merge-claude command to merge-claude.js
          ---
          duration_ms: 245.994833
          type: 'test'
          ...
# Error: Unknown command 'unknown-command'
        # Subtest: should handle unknown commands gracefully
        ok 6 - should handle unknown commands gracefully
          ---
          duration_ms: 37.216375
          type: 'test'
          ...
        1..6
    ok 1 - Command Routing
      ---
      duration_ms: 1151.397708
      type: 'suite'
      ...
    # Subtest: Environment Detection
        # Subtest: should detect npm global installation
        ok 1 - should detect npm global installation
          ---
          duration_ms: 1.941167
          type: 'test'
          ...
        # Subtest: should detect local development environment
        ok 2 - should detect local development environment
          ---
          duration_ms: 0.683292
          type: 'test'
          ...
        # Subtest: should find autopm source directory
        ok 3 - should find autopm source directory
          ---
          duration_ms: 0.645375
          type: 'test'
          ...
        1..3
    ok 2 - Environment Detection
      ---
      duration_ms: 3.446666
      type: 'suite'
      ...
# Error: Unknown command 'test-exit-1'
    # Subtest: Script Execution
        # Subtest: should preserve exit codes from child processes
        ok 1 - should preserve exit codes from child processes
          ---
          duration_ms: 34.373834
          type: 'test'
          ...
        # Subtest: should pass arguments to child scripts
        ok 2 - should pass arguments to child scripts
          ---
          duration_ms: 462.348041
          type: 'test'
          ...
        # Subtest: should handle SIGINT gracefully
        ok 3 - should handle SIGINT gracefully
          ---
          duration_ms: 103.954709
          type: 'test'
          ...
        1..3
    ok 3 - Script Execution
      ---
      duration_ms: 600.825792
      type: 'suite'
      ...
    # Subtest: Backwards Compatibility
        # Subtest: should support same CLI interface as bash version
        ok 1 - should support same CLI interface as bash version
          ---
          duration_ms: 0.620625
          type: 'test'
          ...
        # Subtest: should maintain same output format
        ok 2 - should maintain same output format
          ---
          duration_ms: 43.483
          type: 'test'
          ...
        1..2
    ok 4 - Backwards Compatibility
      ---
      duration_ms: 44.212666
      type: 'suite'
      ...
    # Subtest: Performance
        # Subtest: should start faster than bash version
        ok 1 - should start faster than bash version
          ---
          duration_ms: 52.93125
          type: 'test'
          ...
        # Subtest: should handle concurrent executions
        ok 2 - should handle concurrent executions
          ---
          duration_ms: 328.561167
          type: 'test'
          ...
        1..2
    ok 5 - Performance
      ---
      duration_ms: 381.619792
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should show helpful error messages
        ok 1 - should show helpful error messages
          ---
          duration_ms: 38.634958
          type: 'test'
          ...
        # Subtest: should handle missing dependencies gracefully
        ok 2 - should handle missing dependencies gracefully
          ---
          duration_ms: 0.74175
          type: 'test'
          ...
        1..2
    ok 6 - Error Handling
      ---
      duration_ms: 39.469541
      type: 'suite'
      ...
    1..6
ok 5 - AutoPM CLI Migration Tests
  ---
  duration_ms: 2221.462083
  type: 'suite'
  ...
# Running Integration Test Migration tests...
# These tests are expected to FAIL initially (RED phase)
# Implement test/installation/integration.test.js to make them pass
# Subtest: Integration Test Script Migration
    # Subtest: Core Functionality
        # Subtest: should check if Node.js version exists
        ok 1 - should check if Node.js version exists
          ---
          duration_ms: 3.131208
          type: 'test'
          ...
        # Subtest: should test multiple installation scenarios
        ok 2 - should test multiple installation scenarios
          ---
          duration_ms: 0.905333
          type: 'test'
          ...
        # Subtest: should create test directories for each scenario
        ok 3 - should create test directories for each scenario
          ---
          duration_ms: 1.231333
          type: 'test'
          ...
        # Subtest: should verify core files after installation
        ok 4 - should verify core files after installation
          ---
          duration_ms: 0.737
          type: 'test'
          ...
        1..4
    ok 1 - Core Functionality
      ---
      duration_ms: 6.5435
      type: 'suite'
      ...
    # Subtest: Test Execution
        # Subtest: should support running individual scenarios
        ok 1 - should support running individual scenarios
          ---
          duration_ms: 0.64675
          type: 'test'
          ...
        # Subtest: should run in test mode with AUTOPM_TEST_MODE
        ok 2 - should run in test mode with AUTOPM_TEST_MODE
          ---
          duration_ms: 0.376792
          type: 'test'
          ...
        1..2
    ok 2 - Test Execution
      ---
      duration_ms: 1.2505
      type: 'suite'
      ...
    # Subtest: Results Reporting
        # Subtest: should track passed and failed tests
        ok 1 - should track passed and failed tests
          ---
          duration_ms: 0.52525
          type: 'test'
          ...
        # Subtest: should provide detailed summary
        ok 2 - should provide detailed summary
          ---
          duration_ms: 0.452041
          type: 'test'
          ...
        # Subtest: should exit with appropriate code
        ok 3 - should exit with appropriate code
          ---
          duration_ms: 0.563
          type: 'test'
          ...
        1..3
    ok 3 - Results Reporting
      ---
      duration_ms: 1.66625
      type: 'suite'
      ...
    # Subtest: Cleanup
        # Subtest: should clean up test directories
        ok 1 - should clean up test directories
          ---
          duration_ms: 1.136083
          type: 'test'
          ...
        # Subtest: should handle cleanup errors gracefully
        ok 2 - should handle cleanup errors gracefully
          ---
          duration_ms: 0.406292
          type: 'test'
          ...
        1..2
    ok 4 - Cleanup
      ---
      duration_ms: 1.610083
      type: 'suite'
      ...
    1..4
ok 6 - Integration Test Script Migration
  ---
  duration_ms: 11.496375
  type: 'suite'
  ...
# Running Local Test Runner TDD tests...
# These tests are expected to FAIL initially (RED phase)
# Implement scripts/local-test-runner.js to make them pass (GREEN phase)
# Subtest: Local Test Runner Migration Tests
    # Subtest: Core Functionality
        # Subtest: should check if script exists
        ok 1 - should check if script exists
          ---
          duration_ms: 4.703583
          type: 'test'
          ...
        # Subtest: should run full test suite by default
        ok 2 - should run full test suite by default
          ---
          duration_ms: 1284.192375
          type: 'test'
          ...
        # Subtest: should support --quick mode
        ok 3 - should support --quick mode
          ---
          duration_ms: 484.235334
          type: 'test'
          ...
        1..3
    ok 1 - Core Functionality
      ---
      duration_ms: 1773.846834
      type: 'suite'
      ...
    # Subtest: Output Formatting
        # Subtest: should use colored output
        ok 1 - should use colored output
          ---
          duration_ms: 382.929
          type: 'test'
          ...
        # Subtest: should show test summary
        ok 2 - should show test summary
          ---
          duration_ms: 349.440041
          type: 'test'
          ...
        1..2
    ok 2 - Output Formatting
      ---
      duration_ms: 732.566583
      type: 'suite'
      ...
    # Subtest: Exit Codes
        # Subtest: should exit with 0 when all tests pass
        ok 1 - should exit with 0 when all tests pass
          ---
          duration_ms: 352.700625
          type: 'test'
          ...
        # Subtest: should exit with 1 when tests fail
        ok 2 - should exit with 1 when tests fail
          ---
          duration_ms: 346.711584
          type: 'test'
          ...
        1..2
    ok 3 - Exit Codes
      ---
      duration_ms: 699.724542
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should handle missing npm scripts gracefully
        ok 1 - should handle missing npm scripts gracefully
          ---
          duration_ms: 197.711083
          type: 'test'
          ...
        # Subtest: should provide helpful error messages
        ok 2 - should provide helpful error messages
          ---
          duration_ms: 301.787125
          type: 'test'
          ...
        1..2
    ok 4 - Error Handling
      ---
      duration_ms: 499.612917
      type: 'suite'
      ...
    1..4
ok 7 - Local Test Runner Migration Tests
  ---
  duration_ms: 3706.107958
  type: 'suite'
  ...
# Running Test Runner TDD tests...
# These tests are expected to FAIL initially (RED phase)
# Implement scripts/test.js to make them pass (GREEN phase)
# Subtest: Test Runner Migration Tests
    # Subtest: Core Functionality
        # Subtest: should execute and exist
        ok 1 - should execute and exist
          ---
          duration_ms: 3.487625
          type: 'test'
          ...
        # Subtest: should run all test suites sequentially
        ok 2 - should run all test suites sequentially
          ---
          duration_ms: 55.203959
          type: 'test'
          ...
# (node:93344) Warning: node:test run() is being called recursively within a test file. skipping running files.
# (Use `node --trace-warnings ...` to show where the warning was created)
        # Subtest: should exit with 0 on all tests passing
        ok 3 - should exit with 0 on all tests passing
          ---
          duration_ms: 125.227584
          type: 'test'
          ...
        # Subtest: should exit with 1 on any test failure
        ok 4 - should exit with 1 on any test failure
          ---
          duration_ms: 339.307709
          type: 'test'
          ...
        1..4
    ok 1 - Core Functionality
      ---
      duration_ms: 523.828875
      type: 'suite'
      ...
# (node:93477) Warning: node:test run() is being called recursively within a test file. skipping running files.
# (Use `node --trace-warnings ...` to show where the warning was created)
    # Subtest: Test Suite Discovery
        # Subtest: should discover unit tests
        ok 1 - should discover unit tests
          ---
          duration_ms: 256.853
          type: 'test'
          ...
# (node:93527) Warning: node:test run() is being called recursively within a test file. skipping running files.
# (Use `node --trace-warnings ...` to show where the warning was created)
        # Subtest: should discover Azure provider tests
        ok 2 - should discover Azure provider tests
          ---
          duration_ms: 73.460583
          type: 'test'
          ...
        # Subtest: should skip installation tests in CI environment
        ok 3 - should skip installation tests in CI environment
          ---
          duration_ms: 107.525416
          type: 'test'
          ...
        1..3
    ok 2 - Test Suite Discovery
      ---
      duration_ms: 438.168667
      type: 'suite'
      ...
    # Subtest: Output Formatting
        # Subtest: should display emoji indicators
        ok 1 - should display emoji indicators
          ---
          duration_ms: 76.145417
          type: 'test'
          ...
        # Subtest: should show test summary with counts
        ok 2 - should show test summary with counts
          ---
          duration_ms: 91.741875
          type: 'test'
          ...
# (node:93609) Warning: node:test run() is being called recursively within a test file. skipping running files.
# (Use `node --trace-warnings ...` to show where the warning was created)
        # Subtest: should list failed suites
        ok 3 - should list failed suites
          ---
          duration_ms: 70.432334
          type: 'test'
          ...
        1..3
    ok 3 - Output Formatting
      ---
      duration_ms: 238.631167
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should handle missing test directories gracefully
        ok 1 - should handle missing test directories gracefully
          ---
          duration_ms: 114.862166
          type: 'test'
          ...
# (node:93656) Warning: node:test run() is being called recursively within a test file. skipping running files.
# (Use `node --trace-warnings ...` to show where the warning was created)
        # Subtest: should handle test execution errors
        ok 2 - should handle test execution errors
          ---
          duration_ms: 107.283459
          type: 'test'
          ...
        1..2
    ok 4 - Error Handling
      ---
      duration_ms: 222.26375
      type: 'suite'
      ...
    # Subtest: Performance
        # Subtest: should complete quickly with no tests
        ok 1 - should complete quickly with no tests
          ---
          duration_ms: 35.518875
          type: 'test'
          ...
        1..1
    ok 5 - Performance
      ---
      duration_ms: 35.618709
      type: 'suite'
      ...
    # Subtest: Backwards Compatibility
        # Subtest: should maintain same output format as bash version
        ok 1 - should maintain same output format as bash version
          ---
          duration_ms: 159.394375
          type: 'test'
          ...
        # Subtest: should support same test discovery patterns
        ok 2 - should support same test discovery patterns
          ---
          duration_ms: 1.401791
          type: 'test'
          ...
        1..2
    ok 6 - Backwards Compatibility
      ---
      duration_ms: 160.902542
      type: 'suite'
      ...
    1..6
ok 8 - Test Runner Migration Tests
  ---
  duration_ms: 1619.882292
  type: 'suite'
  ...
1..8
# tests 100
# suites 47
# pass 100
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 3775.149125

> claude-autopm@1.5.29 test:migration
> node --test test/migration/*.test.js

TAP version 13
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure DevOps Active Work Migration Tests
ok 1 - Azure DevOps Active Work Migration Tests
  ---
  duration_ms: 0.242667
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure DevOps Daily Workflow Migration Tests
ok 2 - Azure DevOps Daily Workflow Migration Tests
  ---
  duration_ms: 0.728958
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure DevOps Dashboard Migration Tests
ok 3 - Azure DevOps Dashboard Migration Tests
  ---
  duration_ms: 0.351542
  type: 'suite'
  ...
# Subtest: Azure Feature List Migration Tests - REQUIRES AZURE DEVOPS INTEGRATION
ok 4 - Azure Feature List Migration Tests - REQUIRES AZURE DEVOPS INTEGRATION # SKIP
  ---
  duration_ms: 0.233334
  type: 'suite'
  ...
# Subtest: Azure Feature Show Migration
    # Subtest: Basic Functionality
        # Subtest: should show usage when no feature ID provided
        ok 1 - should show usage when no feature ID provided
          ---
          duration_ms: 4.140959
          type: 'test'
          ...
        # Subtest: should accept feature ID as argument
        ok 2 - should accept feature ID as argument
          ---
          duration_ms: 0.761625
          type: 'test'
          ...
        1..2
    ok 1 - Basic Functionality
      ---
      duration_ms: 5.246375
      type: 'suite'
      ...
    # Subtest: Feature Display
        # Subtest: should display feature details with proper formatting
        ok 1 - should display feature details with proper formatting
          ---
          duration_ms: 0.351209
          type: 'test'
          ...
        # Subtest: should handle feature not found error
        ok 2 - should handle feature not found error
          ---
          duration_ms: 0.202458
          type: 'test'
          ...
        1..2
    ok 2 - Feature Display
      ---
      duration_ms: 0.843292
      type: 'suite'
      ...
    # Subtest: User Stories Display
        # Subtest: should display linked user stories
        ok 1 - should display linked user stories
          ---
          duration_ms: 0.178542
          type: 'test'
          ...
        # Subtest: should calculate and display progress
        ok 2 - should calculate and display progress
          ---
          duration_ms: 0.070208
          type: 'test'
          ...
        1..2
    ok 3 - User Stories Display
      ---
      duration_ms: 1.116792
      type: 'suite'
      ...
    # Subtest: Health Status
        # Subtest: should warn when no owner assigned
        ok 1 - should warn when no owner assigned
          ---
          duration_ms: 0.121458
          type: 'test'
          ...
        # Subtest: should warn when no target date set
        ok 2 - should warn when no target date set
          ---
          duration_ms: 0.069959
          type: 'test'
          ...
        # Subtest: should warn when no stories created
        ok 3 - should warn when no stories created
          ---
          duration_ms: 0.190375
          type: 'test'
          ...
        1..3
    ok 4 - Health Status
      ---
      duration_ms: 0.458333
      type: 'suite'
      ...
    # Subtest: Integration Tests
        # Subtest: should work with real Azure DevOps API structure
        ok 1 - should work with real Azure DevOps API structure
          ---
          duration_ms: 0.101833
          type: 'test'
          ...
        1..1
    ok 5 - Integration Tests
      ---
      duration_ms: 0.127542
      type: 'suite'
      ...
    # Subtest: Backward Compatibility
        # Subtest: should maintain same output format as bash version
        ok 1 - should maintain same output format as bash version
          ---
          duration_ms: 0.071833
          type: 'test'
          ...
        # Subtest: should support same command-line arguments
        ok 2 - should support same command-line arguments
          ---
          duration_ms: 0.05525
          type: 'test'
          ...
        1..2
    ok 6 - Backward Compatibility
      ---
      duration_ms: 0.156083
      type: 'suite'
      ...
    1..6
ok 5 - Azure Feature Show Migration
  ---
  duration_ms: 8.4685
  type: 'suite'
  ...
# Subtest: Azure Feature Status Migration
    # Subtest: Basic Functionality
        # Subtest: should display all features with their status
        ok 1 - should display all features with their status
          ---
          duration_ms: 2.568917
          type: 'test'
          ...
        # Subtest: should handle no features found scenario
        ok 2 - should handle no features found scenario
          ---
          duration_ms: 0.558792
          type: 'test'
          ...
        1..2
    ok 1 - Basic Functionality
      ---
      duration_ms: 4.631833
      type: 'suite'
      ...
    # Subtest: Filtering Options
        # Subtest: should filter by state when --state provided
        ok 1 - should filter by state when --state provided
          ---
          duration_ms: 0.384166
          type: 'test'
          ...
        # Subtest: should filter by iteration when --iteration provided
        ok 2 - should filter by iteration when --iteration provided
          ---
          duration_ms: 0.769209
          type: 'test'
          ...
        # Subtest: should filter by area when --area provided
        ok 3 - should filter by area when --area provided
          ---
          duration_ms: 0.165375
          type: 'test'
          ...
        # Subtest: should filter unassigned features with --unassigned flag
        ok 4 - should filter unassigned features with --unassigned flag
          ---
          duration_ms: 0.077
          type: 'test'
          ...
        1..4
    ok 2 - Filtering Options
      ---
      duration_ms: 1.671666
      type: 'suite'
      ...
    # Subtest: Progress Calculation
        # Subtest: should calculate progress for each feature
        ok 1 - should calculate progress for each feature
          ---
          duration_ms: 0.77
          type: 'test'
          ...
        # Subtest: should display features at risk
        ok 2 - should display features at risk
          ---
          duration_ms: 0.113583
          type: 'test'
          ...
        1..2
    ok 3 - Progress Calculation
      ---
      duration_ms: 1.036542
      type: 'suite'
      ...
    # Subtest: Output Formats
        # Subtest: should display in table format by default
        ok 1 - should display in table format by default
          ---
          duration_ms: 0.195667
          type: 'test'
          ...
        # Subtest: should display in JSON format when --json flag used
        ok 2 - should display in JSON format when --json flag used
          ---
          duration_ms: 0.194791
          type: 'test'
          ...
        # Subtest: should display in summary format when --summary flag used
        ok 3 - should display in summary format when --summary flag used
          ---
          duration_ms: 0.085167
          type: 'test'
          ...
        1..3
    ok 4 - Output Formats
      ---
      duration_ms: 0.533917
      type: 'suite'
      ...
    # Subtest: Sorting Options
        # Subtest: should sort by target date by default
        ok 1 - should sort by target date by default
          ---
          duration_ms: 0.086917
          type: 'test'
          ...
        # Subtest: should sort by progress when --sort progress
        ok 2 - should sort by progress when --sort progress
          ---
          duration_ms: 0.062375
          type: 'test'
          ...
        # Subtest: should sort by state when --sort state
        ok 3 - should sort by state when --sort state
          ---
          duration_ms: 0.070458
          type: 'test'
          ...
        1..3
    ok 5 - Sorting Options
      ---
      duration_ms: 0.257958
      type: 'suite'
      ...
    # Subtest: Integration Tests
        # Subtest: should work with real Azure DevOps API structure
        ok 1 - should work with real Azure DevOps API structure
          ---
          duration_ms: 0.073584
          type: 'test'
          ...
        1..1
    ok 6 - Integration Tests
      ---
      duration_ms: 0.09675
      type: 'suite'
      ...
    # Subtest: Backward Compatibility
        # Subtest: should maintain same output format as bash version
        ok 1 - should maintain same output format as bash version
          ---
          duration_ms: 0.201458
          type: 'test'
          ...
        # Subtest: should support same command-line arguments
        ok 2 - should support same command-line arguments
          ---
          duration_ms: 0.06075
          type: 'test'
          ...
        1..2
    ok 7 - Backward Compatibility
      ---
      duration_ms: 0.2875
      type: 'suite'
      ...
    1..7
ok 6 - Azure Feature Status Migration
  ---
  duration_ms: 9.05125
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure Help Migration
ok 7 - Azure Help Migration
  ---
  duration_ms: 0.268417
  type: 'suite'
  ...
# Subtest: Azure Scripts Integration Tests - REQUIRES AZURE DEVOPS INTEGRATION
ok 8 - Azure Scripts Integration Tests - REQUIRES AZURE DEVOPS INTEGRATION # SKIP
  ---
  duration_ms: 0.23825
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure Next Task Migration Tests
ok 9 - Azure Next Task Migration Tests
  ---
  duration_ms: 0.224417
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure Search Migration
ok 10 - Azure Search Migration
  ---
  duration_ms: 0.260208
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure DevOps Setup Migration Tests
ok 11 - Azure DevOps Setup Migration Tests
  ---
  duration_ms: 0.235458
  type: 'suite'
  ...
# Subtest: Azure Sprint Report Migration Tests - REQUIRES AZURE DEVOPS INTEGRATION
ok 12 - Azure Sprint Report Migration Tests - REQUIRES AZURE DEVOPS INTEGRATION # SKIP
  ---
  duration_ms: 0.279292
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure DevOps Sync Migration Tests
ok 13 - Azure DevOps Sync Migration Tests
  ---
  duration_ms: 0.315167
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure US List Migration
ok 14 - Azure US List Migration
  ---
  duration_ms: 0.266208
  type: 'suite'
  ...
# Skipping Azure DevOps tests (set AZURE_DEVOPS_INTEGRATION_TESTS=true to run)
# Subtest: Azure US Status Migration
ok 15 - Azure US Status Migration
  ---
  duration_ms: 0.267375
  type: 'suite'
  ...
# Subtest: PM Validation Backward Compatibility
    # Subtest: wrapper script should delegate to Node.js implementation
    ok 1 - wrapper script should delegate to Node.js implementation
      ---
      duration_ms: 69.66275
      type: 'test'
      ...
    # Subtest: Node.js script can be executed directly
    ok 2 - Node.js script can be executed directly
      ---
      duration_ms: 49.654917
      type: 'test'
      ...
    # Subtest: both implementations produce equivalent results
    ok 3 - both implementations produce equivalent results
      ---
      duration_ms: 93.67325
      type: 'test'
      ...
    # Subtest: exit codes are consistent
    ok 4 - exit codes are consistent
      ---
      duration_ms: 73.0115
      type: 'test'
      ...
    # Subtest: error and warning reporting is consistent
    ok 5 - error and warning reporting is consistent
      ---
      duration_ms: 71.965666
      type: 'test'
      ...
    1..5
ok 16 - PM Validation Backward Compatibility
  ---
  duration_ms: 358.816
  type: 'suite'
  ...
# Error parsing YAML frontmatter: YAMLException: bad indentation of a mapping entry (1:14)
#  1 | invalid: yaml: content:
# ------------------^
#     at generateError (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:183:10)
#     at throwError (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:187:9)
#     at readBlockMapping (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1182:7)
#     at composeNode (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1441:12)
#     at readDocument (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1625:3)
#     at loadDocuments (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1688:5)
#     at Object.load (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1714:19)
#     at MCPHandler.parseServerFile (/Users/rla/Projects/AUTOPM/scripts/mcp-handler.js:370:19)
#     at /Users/rla/Projects/AUTOPM/scripts/mcp-handler.js:342:29
#     at Array.map (<anonymous>) {
#   reason: 'bad indentation of a mapping entry',
#   mark: {
#     name: null,
#     buffer: 'invalid: yaml: content:\\n',
#     position: 13,
#     line: 0,
#     column: 13,
#     snippet: ' 1 | invalid: yaml: content:\\n------------------^'
#   }
# }
# ðŸ“¡ Available MCP Servers:
# âœ… Active active-server
#     Category: testing
#     Description: Active test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-Fm3XCX/framework/autopm/.claude/mcp/active-server.md
# âšª Inactive inactive-server
#     Category: development
#     Description: Inactive test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-Fm3XCX/framework/autopm/.claude/mcp/inactive-server.md
# Total: 2 servers (1 active)
# ðŸ“¡ Available MCP Servers:
# âœ… Active active-server
#     Category: testing
#     Description: Active test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-msMg3m/framework/autopm/.claude/mcp/active-server.md
# âšª Inactive inactive-server
#     Category: development
#     Description: Inactive test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-msMg3m/framework/autopm/.claude/mcp/inactive-server.md
# âšª Inactive no-metadata
#     Category: uncategorized
#     Description: No description
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-msMg3m/framework/autopm/.claude/mcp/no-metadata.md
# Total: 3 servers (1 active)
# ðŸ“¡ Available MCP Servers:
# âšª Inactive active-server
#     Category: testing
#     Description: Active test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-L1N1As/framework/autopm/.claude/mcp/active-server.md
# âšª Inactive inactive-server
#     Category: development
#     Description: Inactive test server
#     Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-L1N1As/framework/autopm/.claude/mcp/inactive-server.md
# Total: 2 servers (0 active)
# âœ… Server 'test-server' enabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# âœ… Server 'test-server' enabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# âœ… Server 'test-server' enabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# â„¹ï¸ Server 'test-server' is already enabled
# âœ… Server 'nonexistent-server' enabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# âœ… Server 'test-server' enabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# âŒ Server 'nonexistent-server' not found
# âœ… Server 'test-server' disabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# â„¹ï¸ Server 'nonactive-server' is not enabled
# â„¹ï¸ Server 'test-server' is not enabled
# â„¹ï¸ Server 'test-server' is not enabled
# âœ… Server 'test-server' disabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# ðŸ”„ Syncing MCP server configuration...
#   âœ… Synced: server1
#   âœ… Synced: server2
# âœ… Configuration synced to /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-WijrL0/.claude/mcp-servers.json
# ðŸ“Š Active servers: 2
# ðŸ”„ Syncing MCP server configuration...
# â„¹ï¸ No active servers to sync
# ðŸ”„ Syncing MCP server configuration...
#   âœ… Synced: server1
# âš ï¸ Server 'nonexistent-server' not found, skipping
# âœ… Configuration synced to /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-gPCZGT/.claude/mcp-servers.json
# ðŸ“Š Active servers: 2
# ðŸ”„ Syncing MCP server configuration...
#   âœ… Synced: server2
# âœ… Configuration synced to /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-RRVbpm/.claude/mcp-servers.json
# ðŸ“Š Active servers: 1
# ðŸ”„ Syncing MCP server configuration...
# â„¹ï¸ No active servers to sync
# ðŸ” Validating MCP servers...
# Checking valid-server...
# ðŸ“Š Validation Results:
#   Total servers: 1
#   Errors: 0
#   Warnings: 0
# âœ… All servers validated successfully
# ðŸ” Validating MCP servers...
# Checking invalid-server...
# ðŸ“Š Validation Results:
#   Total servers: 1
#   Errors: 2
#   Warnings: 1
#   âŒ Missing command
#   âŒ Missing args
#   âš ï¸ Missing category
# âŒ Validation failed with errors
# ðŸ” Validating MCP servers...
# Checking incomplete-server...
# ðŸ“Š Validation Results:
#   Total servers: 1
#   Errors: 0
#   Warnings: 2
# âœ… All servers validated successfully
#   âš ï¸ Missing description
#   âš ï¸ Missing category
# ðŸ” Validating MCP servers...
# Checking suspicious-env-server...
# ðŸ“Š Validation Results:
#   Total servers: 1
#   Errors: 0
#   Warnings: 2
# âœ… All servers validated successfully
#   âš ï¸ Missing category
#   âš ï¸ Env var SUSPICIOUS_VAR might have incorrect syntax
# ðŸ” Validating MCP servers...
# ðŸ“Š Validation Results:
#   Total servers: 0
#   Errors: 0
#   Warnings: 0
# âœ… All servers validated successfully
# ðŸ“¡ MCP Server: info-test-server
# ==================================================
# Status: âœ… Active
# Category: testing
# Description: Server for info testing
# Version: >=2.0.0
# ðŸ“¦ Command:
#   npx @info/test-server --flag
# ðŸ”§ Environment Variables:
#   API_KEY=${API_KEY:-your-key-here}
#   DEBUG=${DEBUG:-false}
# ðŸ“„ Environment File: .claude/.env
# ðŸ“ Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-tTXYni/framework/autopm/.claude/mcp/info-test-server.md
# âœ… Server 'info-test-server' disabled
# ðŸ’¡ Run 'autopm mcp sync' to update configuration
# ðŸ“¡ MCP Server: info-test-server
# ==================================================
# Status: âšª Inactive
# Category: testing
# Description: Server for info testing
# Version: >=2.0.0
# ðŸ“¦ Command:
#   npx @info/test-server --flag
# ðŸ”§ Environment Variables:
#   API_KEY=${API_KEY:-your-key-here}
#   DEBUG=${DEBUG:-false}
# ðŸ“„ Environment File: .claude/.env
# ðŸ“ Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-Bd65vL/framework/autopm/.claude/mcp/info-test-server.md
# ðŸ“¡ MCP Server: minimal-server
# ==================================================
# Status: âšª Inactive
# Category: uncategorized
# Description: No description
# Version: any
# ðŸ“¦ Command:
#   node minimal.js
# ðŸ“ Location: /var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-handler-test-G0ThM6/framework/autopm/.claude/mcp/minimal-server.md
# âŒ Server 'nonexistent-server' not found
# ðŸ“¡ MCP Server: nonexistent-server
# ==================================================
# Status: âšª Inactive
# Error parsing YAML frontmatter: YAMLException: bad indentation of a mapping entry (1:14)
#  1 | invalid: yaml: content:
# ------------------^
#  2 | broken yaml
#     at generateError (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:183:10)
#     at throwError (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:187:9)
#     at readBlockMapping (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1182:7)
#     at composeNode (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1441:12)
#     at readDocument (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1625:3)
#     at loadDocuments (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1688:5)
#     at Object.load (/Users/rla/Projects/AUTOPM/node_modules/js-yaml/lib/loader.js:1714:19)
#     at MCPHandler.parseServerFile (/Users/rla/Projects/AUTOPM/scripts/mcp-handler.js:370:19)
#     at TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:943:32)
#     at Test.runInAsyncScope (node:async_hooks:214:14) {
#   reason: 'bad indentation of a mapping entry',
#   mark: {
#     name: null,
#     buffer: 'invalid: yaml: content:\\nbroken yaml\\n',
#     position: 13,
#     line: 0,
#     column: 13,
#     snippet: ' 1 | invalid: yaml: content:\\n------------------^\\n 2 | broken yaml'
#   }
# }
# ðŸ“ TODO: Update registry for test-server
# ðŸ“ TODO: Remove test-server from registry
# Subtest: MCP Handler Tests
    # Subtest: Constructor and Path Setup
        # Subtest: should initialize with correct default paths
        ok 1 - should initialize with correct default paths
          ---
          duration_ms: 11.875583
          type: 'test'
          ...
        # Subtest: should set up paths relative to current working directory
        ok 2 - should set up paths relative to current working directory
          ---
          duration_ms: 1.995041
          type: 'test'
          ...
        1..2
    ok 1 - Constructor and Path Setup
      ---
      duration_ms: 14.248084
      type: 'suite'
      ...
    # Subtest: getAllServers Method
        # Subtest: should return empty array when MCP directory does not exist
        ok 1 - should return empty array when MCP directory does not exist
          ---
          duration_ms: 1.595791
          type: 'test'
          ...
        # Subtest: should return empty array when MCP directory is empty
        ok 2 - should return empty array when MCP directory is empty
          ---
          duration_ms: 2.626333
          type: 'test'
          ...
        # Subtest: should ignore MCP-REGISTRY.md file
        ok 3 - should ignore MCP-REGISTRY.md file
          ---
          duration_ms: 3.054584
          type: 'test'
          ...
        # Subtest: should parse valid server files
        ok 4 - should parse valid server files
          ---
          duration_ms: 4.55175
          type: 'test'
          ...
        # Subtest: should handle multiple server files
        ok 5 - should handle multiple server files
          ---
          duration_ms: 2.71
          type: 'test'
          ...
        # Subtest: should handle files with invalid YAML frontmatter
        ok 6 - should handle files with invalid YAML frontmatter
          ---
          duration_ms: 3.296709
          type: 'test'
          ...
        # Subtest: should handle files without frontmatter
        ok 7 - should handle files without frontmatter
          ---
          duration_ms: 1.947917
          type: 'test'
          ...
        1..7
    ok 2 - getAllServers Method
      ---
      duration_ms: 20.459708
      type: 'suite'
      ...
    # Subtest: getServer Method
        # Subtest: should return server when it exists
        ok 1 - should return server when it exists
          ---
          duration_ms: 2.147875
          type: 'test'
          ...
        # Subtest: should return undefined when server does not exist
        ok 2 - should return undefined when server does not exist
          ---
          duration_ms: 2.295125
          type: 'test'
          ...
        # Subtest: should be case sensitive
        ok 3 - should be case sensitive
          ---
          duration_ms: 2.227459
          type: 'test'
          ...
        1..3
    ok 3 - getServer Method
      ---
      duration_ms: 6.763125
      type: 'suite'
      ...
    # Subtest: loadConfig and saveConfig Methods
        # Subtest: should return empty object when config file does not exist
        ok 1 - should return empty object when config file does not exist
          ---
          duration_ms: 0.863083
          type: 'test'
          ...
        # Subtest: should load existing config file
        ok 2 - should load existing config file
          ---
          duration_ms: 1.07725
          type: 'test'
          ...
        # Subtest: should save config file with proper formatting
        ok 3 - should save config file with proper formatting
          ---
          duration_ms: 2.00475
          type: 'test'
          ...
        # Subtest: should create .claude directory if it does not exist
        ok 4 - should create .claude directory if it does not exist
          ---
          duration_ms: 1.176167
          type: 'test'
          ...
        1..4
    ok 4 - loadConfig and saveConfig Methods
      ---
      duration_ms: 5.205167
      type: 'suite'
      ...
    # Subtest: list Method
        # Subtest: should display server list with correct status
        ok 1 - should display server list with correct status
          ---
          duration_ms: 2.568208
          type: 'test'
          ...
        # Subtest: should handle servers without metadata gracefully
        ok 2 - should handle servers without metadata gracefully
          ---
          duration_ms: 2.545625
          type: 'test'
          ...
        # Subtest: should show zero active servers when none are configured
        ok 3 - should show zero active servers when none are configured
          ---
          duration_ms: 2.05275
          type: 'test'
          ...
        1..3
    ok 5 - list Method
      ---
      duration_ms: 7.259375
      type: 'suite'
      ...
    # Subtest: enable Method
        # Subtest: should enable a server successfully
        ok 1 - should enable a server successfully
          ---
          duration_ms: 2.361334
          type: 'test'
          ...
        # Subtest: should initialize mcp section in config if not present
        ok 2 - should initialize mcp section in config if not present
          ---
          duration_ms: 1.62725
          type: 'test'
          ...
        # Subtest: should not duplicate server if already enabled
        ok 3 - should not duplicate server if already enabled
          ---
          duration_ms: 3.601708
          type: 'test'
          ...
        # Subtest: should exit with error when server does not exist
        ok 4 - should exit with error when server does not exist
          ---
          duration_ms: 2.632209
          type: 'test'
          ...
        # Subtest: should preserve existing active servers
        ok 5 - should preserve existing active servers
          ---
          duration_ms: 2.183041
          type: 'test'
          ...
        1..5
    ok 6 - enable Method
      ---
      duration_ms: 12.524625
      type: 'suite'
      ...
    # Subtest: disable Method
        # Subtest: should disable an active server successfully
        ok 1 - should disable an active server successfully
          ---
          duration_ms: 2.156583
          type: 'test'
          ...
        # Subtest: should show info message when server is not enabled
        ok 2 - should show info message when server is not enabled
          ---
          duration_ms: 7.343292
          type: 'test'
          ...
        # Subtest: should handle empty config gracefully
        ok 3 - should handle empty config gracefully
          ---
          duration_ms: 6.174083
          type: 'test'
          ...
        # Subtest: should handle config without mcp section
        ok 4 - should handle config without mcp section
          ---
          duration_ms: 4.755459
          type: 'test'
          ...
        # Subtest: should preserve other active servers
        ok 5 - should preserve other active servers
          ---
          duration_ms: 4.717625
          type: 'test'
          ...
        1..5
    ok 7 - disable Method
      ---
      duration_ms: 25.411416
      type: 'suite'
      ...
    # Subtest: sync Method
        # Subtest: should sync active servers to mcp-servers.json
        ok 1 - should sync active servers to mcp-servers.json
          ---
          duration_ms: 6.44275
          type: 'test'
          ...
        # Subtest: should show info message when no active servers
        ok 2 - should show info message when no active servers
          ---
          duration_ms: 11.334041
          type: 'test'
          ...
        # Subtest: should warn about missing servers and skip them
        ok 3 - should warn about missing servers and skip them
          ---
          duration_ms: 10.461333
          type: 'test'
          ...
        # Subtest: should handle servers without env gracefully
        ok 4 - should handle servers without env gracefully
          ---
          duration_ms: 8.236875
          type: 'test'
          ...
        # Subtest: should create .claude directory if it does not exist
        not ok 5 - should create .claude directory if it does not exist
          ---
          duration_ms: 11.78525
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:632:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(fs.existsSync(path.join(mockProjectRoot, '.claude')))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:638:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..5
    not ok 8 - sync Method
      ---
      duration_ms: 48.466583
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:524:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: validate Method
        # Subtest: should pass validation for valid servers
        ok 1 - should pass validation for valid servers
          ---
          duration_ms: 4.672292
          type: 'test'
          ...
        # Subtest: should report errors for missing required fields
        ok 2 - should report errors for missing required fields
          ---
          duration_ms: 4.712542
          type: 'test'
          ...
        # Subtest: should report warnings for missing optional fields
        ok 3 - should report warnings for missing optional fields
          ---
          duration_ms: 5.206917
          type: 'test'
          ...
        # Subtest: should warn about potentially incorrect env var syntax
        not ok 4 - should warn about potentially incorrect env var syntax
          ---
          duration_ms: 5.154042
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:723:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(logOutput.includes('Warnings: 1'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:744:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle empty MCP directory
        ok 5 - should handle empty MCP directory
          ---
          duration_ms: 5.010334
          type: 'test'
          ...
        1..5
    not ok 9 - validate Method
      ---
      duration_ms: 24.899458
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:643:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: info Method
        # Subtest: should display comprehensive server information
        ok 1 - should display comprehensive server information
          ---
          duration_ms: 3.280958
          type: 'test'
          ...
        # Subtest: should show inactive status for disabled servers
        ok 2 - should show inactive status for disabled servers
          ---
          duration_ms: 2.58225
          type: 'test'
          ...
        # Subtest: should handle servers without optional metadata
        ok 3 - should handle servers without optional metadata
          ---
          duration_ms: 1.6675
          type: 'test'
          ...
        # Subtest: should exit with error for nonexistent server
        not ok 4 - should exit with error for nonexistent server
          ---
          duration_ms: 1.570917
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:852:5'
          failureType: 'testCodeFailure'
          error: "Cannot read properties of undefined (reading 'metadata')"
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            MCPHandler.info (/Users/rla/Projects/AUTOPM/scripts/mcp-handler.js:305:37)
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:853:15)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..4
    not ok 10 - info Method
      ---
      duration_ms: 9.19975
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:760:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: generateServerMarkdown Method
        # Subtest: should generate properly formatted markdown with all fields
        ok 1 - should generate properly formatted markdown with all fields
          ---
          duration_ms: 2.301625
          type: 'test'
          ...
        # Subtest: should handle servers without environment variables
        ok 2 - should handle servers without environment variables
          ---
          duration_ms: 1.007666
          type: 'test'
          ...
        1..2
    ok 11 - generateServerMarkdown Method
      ---
      duration_ms: 3.357417
      type: 'suite'
      ...
    # Subtest: parseServerFile Method
        # Subtest: should parse valid YAML frontmatter
        ok 1 - should parse valid YAML frontmatter
          ---
          duration_ms: 0.893625
          type: 'test'
          ...
        # Subtest: should return empty object for content without frontmatter
        ok 2 - should return empty object for content without frontmatter
          ---
          duration_ms: 0.793167
          type: 'test'
          ...
        # Subtest: should return empty object and log error for invalid YAML
        ok 3 - should return empty object and log error for invalid YAML
          ---
          duration_ms: 1.289458
          type: 'test'
          ...
        # Subtest: should handle complex YAML structures
        ok 4 - should handle complex YAML structures
          ---
          duration_ms: 1.06175
          type: 'test'
          ...
        1..4
    ok 12 - parseServerFile Method
      ---
      duration_ms: 4.100458
      type: 'suite'
      ...
    # Subtest: ensureClaudeDir Method
        # Subtest: should create .claude directory if it does not exist
        ok 1 - should create .claude directory if it does not exist
          ---
          duration_ms: 0.866375
          type: 'test'
          ...
        # Subtest: should not fail if .claude directory already exists
        ok 2 - should not fail if .claude directory already exists
          ---
          duration_ms: 0.760334
          type: 'test'
          ...
        1..2
    ok 13 - ensureClaudeDir Method
      ---
      duration_ms: 2.185291
      type: 'suite'
      ...
    # Subtest: Registry Management (Placeholder Methods)
        # Subtest: updateRegistry should log TODO message
        ok 1 - updateRegistry should log TODO message
          ---
          duration_ms: 1.150334
          type: 'test'
          ...
        # Subtest: removeFromRegistry should log TODO message
        ok 2 - removeFromRegistry should log TODO message
          ---
          duration_ms: 0.897917
          type: 'test'
          ...
        1..2
    ok 14 - Registry Management (Placeholder Methods)
      ---
      duration_ms: 2.096583
      type: 'suite'
      ...
    1..14
not ok 17 - MCP Handler Tests
  ---
  duration_ms: 187.036917
  type: 'suite'
  location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-handler.test.js:14:1'
  failureType: 'subtestsFailed'
  error: '3 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: MCP Script Integration
    # Subtest: MCP handler exists
    ok 1 - MCP handler exists
      ---
      duration_ms: 0.338917
      type: 'test'
      ...
    # Subtest: list command should work
    ok 2 - list command should work
      ---
      duration_ms: 47.005917
      type: 'test'
      ...
    # Subtest: bash scripts should delegate to Node.js
    ok 3 - bash scripts should delegate to Node.js
      ---
      duration_ms: 0.32075
      type: 'test'
      ...
    # Subtest: enable script should delegate to Node.js
    ok 4 - enable script should delegate to Node.js
      ---
      duration_ms: 1.513583
      type: 'test'
      ...
    # Subtest: sync script should delegate to Node.js
    ok 5 - sync script should delegate to Node.js
      ---
      duration_ms: 0.618417
      type: 'test'
      ...
    # Subtest: MCP handler should respond to commands
    ok 6 - MCP handler should respond to commands
      ---
      duration_ms: 113.421958
      type: 'test'
      ...
    # Subtest: all MCP scripts should exist
    ok 7 - all MCP scripts should exist
      ---
      duration_ms: 0.478875
      type: 'test'
      ...
    # Subtest: MCP handler can be loaded as module
    ok 8 - MCP handler can be loaded as module
      ---
      duration_ms: 9.078042
      type: 'test'
      ...
    1..8
ok 18 - MCP Script Integration
  ---
  duration_ms: 174.129125
  type: 'test'
  ...
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MXDohw/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MXDohw/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MXDohw/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-UoWIqr/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-UoWIqr/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-UoWIqr/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-iqYvop/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-iqYvop/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-iqYvop/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-8QA5L0/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-8QA5L0/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-8QA5L0/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ltjXJJ/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ltjXJJ/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ltjXJJ/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-p6hjbF/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-p6hjbF/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-p6hjbF/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-kHwc5C/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-kHwc5C/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-kHwc5C/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-tnrGL3/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-tnrGL3/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-tnrGL3/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-JDcloN/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-JDcloN/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-JDcloN/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-izNDbm/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-izNDbm/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-izNDbm/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-nMnPLJ/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-nMnPLJ/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-nMnPLJ/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-YsJZed/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-YsJZed/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-YsJZed/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ndGhVg/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ndGhVg/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-ndGhVg/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-bUUCWK/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-b0mYtO/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-FpgBuL/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MgyAbA/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MgyAbA/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-MgyAbA/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# Subtest: MCP Scripts Integration Tests
    # Subtest: list.sh Script
        # Subtest: should execute successfully and call mcp-handler list
        not ok 1 - should execute successfully and call mcp-handler list
          ---
          duration_ms: 72.277792
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:202:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:205:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
          ...
        # Subtest: should display available servers when they exist
        not ok 2 - should display available servers when they exist
          ---
          duration_ms: 68.152833
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:210:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:215:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should show active status for enabled servers
        not ok 3 - should show active status for enabled servers
          ---
          duration_ms: 58.7735
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:222:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:227:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle multiple servers correctly
        not ok 4 - should handle multiple servers correctly
          ---
          duration_ms: 37.479875
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:237:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:243:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..4
    not ok 1 - list.sh Script
      ---
      duration_ms: 237.176708
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:200:3'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: enable.sh Script
        # Subtest: should enable a server successfully
        not ok 1 - should enable a server successfully
          ---
          duration_ms: 33.923292
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:256:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:259:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should show usage message when no server name provided
        ok 2 - should show usage message when no server name provided
          ---
          duration_ms: 8.989916
          type: 'test'
          ...
        # Subtest: should exit with error for nonexistent server
        not ok 3 - should exit with error for nonexistent server
          ---
          duration_ms: 38.1435
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:280:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('âŒ Server \'nonexistent-server\' not found'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:284:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle already enabled server gracefully
        not ok 4 - should handle already enabled server gracefully
          ---
          duration_ms: 39.609459
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:287:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:290:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should preserve case sensitivity in server names
        not ok 5 - should preserve case sensitivity in server names
          ---
          duration_ms: 36.898583
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:298:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('âŒ Server \'Enable-Test-Server\' not found'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:302:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..5
    not ok 2 - enable.sh Script
      ---
      duration_ms: 157.966209
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:250:3'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: disable.sh Script
        # Subtest: should disable an enabled server successfully
        not ok 1 - should disable an enabled server successfully
          ---
          duration_ms: 39.7835
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:316:5'
          failureType: 'hookFailed'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:313:14)
            TestHook.runInAsyncScope (node:async_hooks:214:14)
            TestHook.run (node:internal/test_runner/test:1047:25)
            TestHook.run (node:internal/test_runner/test:1354:18)
            Suite.runHook (node:internal/test_runner/test:965:20)
            async Test.run (node:internal/test_runner/test:1022:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should show usage message when no server name provided
        not ok 2 - should show usage message when no server name provided
          ---
          duration_ms: 36.832709
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:331:5'
          failureType: 'hookFailed'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:313:14)
            TestHook.runInAsyncScope (node:async_hooks:214:14)
            TestHook.run (node:internal/test_runner/test:1047:25)
            TestHook.run (node:internal/test_runner/test:1354:18)
            Suite.runHook (node:internal/test_runner/test:965:20)
            async Test.run (node:internal/test_runner/test:1022:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should show info message for server that is not enabled
        not ok 3 - should show info message for server that is not enabled
          ---
          duration_ms: 34.55375
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:338:5'
          failureType: 'hookFailed'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:313:14)
            TestHook.runInAsyncScope (node:async_hooks:214:14)
            TestHook.run (node:internal/test_runner/test:1047:25)
            TestHook.run (node:internal/test_runner/test:1354:18)
            Suite.runHook (node:internal/test_runner/test:965:20)
            async Test.run (node:internal/test_runner/test:1022:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle nonexistent server gracefully
        not ok 4 - should handle nonexistent server gracefully
          ---
          duration_ms: 32.729375
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:349:5'
          failureType: 'hookFailed'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:313:14)
            TestHook.runInAsyncScope (node:async_hooks:214:14)
            TestHook.run (node:internal/test_runner/test:1047:25)
            TestHook.run (node:internal/test_runner/test:1354:18)
            Suite.runHook (node:internal/test_runner/test:965:20)
            async Test.run (node:internal/test_runner/test:1022:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should preserve other active servers when disabling one
        not ok 5 - should preserve other active servers when disabling one
          ---
          duration_ms: 33.837375
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:356:5'
          failureType: 'hookFailed'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:313:14)
            TestHook.runInAsyncScope (node:async_hooks:214:14)
            TestHook.run (node:internal/test_runner/test:1047:25)
            TestHook.run (node:internal/test_runner/test:1354:18)
            Suite.runHook (node:internal/test_runner/test:965:20)
            async Test.run (node:internal/test_runner/test:1022:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..5
    not ok 3 - disable.sh Script
      ---
      duration_ms: 177.866041
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:306:3'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: sync.sh Script
        # Subtest: should sync active servers to mcp-servers.json
        not ok 1 - should sync active servers to mcp-servers.json
          ---
          duration_ms: 122.48275
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:384:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:387:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should show info message when no active servers
        not ok 2 - should show info message when no active servers
          ---
          duration_ms: 155.618875
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:408:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:415:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle missing servers gracefully
        not ok 3 - should handle missing servers gracefully
          ---
          duration_ms: 65.798542
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:423:5'
          failureType: 'testCodeFailure'
          error: "ENOENT: no such file or directory, open '/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HREW1P/.claude/config.json'"
          code: 'ENOENT'
          stack: |-
            Object.readFileSync (node:fs:441:20)
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:426:36)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should create .claude directory if it does not exist
        not ok 4 - should create .claude directory if it does not exist
          ---
          duration_ms: 131.336791
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:445:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:454:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..4
    not ok 4 - sync.sh Script
      ---
      duration_ms: 475.340666
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:374:3'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: add.sh Script (Interactive)
        # Subtest: should execute add command
        ok 1 - should execute add command
          ---
          duration_ms: 30.245292
          type: 'test'
          ...
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module '/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-dgN6bp/framework/scripts/mcp-handler.js'
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:171:5)
#     at node:internal/main/run_main_module:36:49 {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: []
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-KDMPMD/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-KDMPMD/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-KDMPMD/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-IeuTBW/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-IeuTBW/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-IeuTBW/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HvPBfd/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HvPBfd/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-HvPBfd/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-PQO0XU/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-PQO0XU/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-PQO0XU/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
        # Subtest: should show server creation prompt
        not ok 2 - should show server creation prompt
          ---
          duration_ms: 115.352
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:470:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(error.message.includes('timeout') || error.message.includes('exit'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:480:16)
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..2
    not ok 5 - add.sh Script (Interactive)
      ---
      duration_ms: 145.751667
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:460:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Script Path Resolution
        # Subtest: all scripts should correctly resolve framework root path
        ok 1 - all scripts should correctly resolve framework root path
          ---
          duration_ms: 2.105375
          type: 'test'
          ...
        # Subtest: scripts should be executable
        ok 2 - scripts should be executable
          ---
          duration_ms: 1.884083
          type: 'test'
          ...
        # Subtest: scripts should handle mcp-handler.js not found gracefully
        ok 3 - scripts should handle mcp-handler.js not found gracefully
          ---
          duration_ms: 30.837
          type: 'test'
          ...
        1..3
    ok 6 - Script Path Resolution
      ---
      duration_ms: 34.891125
      type: 'suite'
      ...
    # Subtest: Error Handling and Edge Cases
        # Subtest: should handle corrupted config.json gracefully
        not ok 1 - should handle corrupted config.json gracefully
          ---
          duration_ms: 33.159958
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:531:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('JSON') || result.stderr.includes('parse'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:540:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle missing .claude directory permissions
        not ok 2 - should handle missing .claude directory permissions
          ---
          duration_ms: 32.845042
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:543:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('permission') ||
                       result.stderr.includes('EACCES') ||
                       result.stderr.includes('EPERM'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:552:16)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle very long server names
        not ok 3 - should handle very long server names
          ---
          duration_ms: 35.328625
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:558:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('not found'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:564:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should handle special characters in server names
        not ok 4 - should handle special characters in server names
          ---
          duration_ms: 34.930917
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:567:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.stderr.includes('not found'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:573:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            process.processTicksAndRejections (node:internal/process/task_queues:105:5)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-2uBGX9/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-2uBGX9/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-2uBGX9/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
# node:internal/modules/cjs/loader:1386
#   throw err;
#   ^
# Error: Cannot find module 'js-yaml'
# Require stack:
# - /private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js
#     at Function._resolveFilename (node:internal/modules/cjs/loader:1383:15)
#     at defaultResolveImpl (node:internal/modules/cjs/loader:1025:19)
#     at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1030:22)
#     at Function._load (node:internal/modules/cjs/loader:1192:37)
#     at TracingChannel.traceSync (node:diagnostics_channel:322:14)
#     at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)
#     at Module.require (node:internal/modules/cjs/loader:1463:12)
#     at require (node:internal/modules/helpers:147:16)
#     at Object.<anonymous> (/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js:9:14)
#     at Module._compile (node:internal/modules/cjs/loader:1706:14) {
#   code: 'MODULE_NOT_FOUND',
#   requireStack: [
#     '/private/var/folders/6r/nlf3scq92x36d174267fqbb00000gn/T/mcp-scripts-test-NM0XZX/framework/scripts/mcp-handler.js'
#   ]
# }
# Node.js v22.19.0
        # Subtest: should handle concurrent script execution
        not ok 5 - should handle concurrent script execution
          ---
          duration_ms: 193.490834
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:576:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(successfulResults.length > 0)
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:590:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..5
    not ok 7 - Error Handling and Edge Cases
      ---
      duration_ms: 329.959792
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:529:3'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Integration with Real MCP Handler
        # Subtest: should pass through all commands correctly
        not ok 1 - should pass through all commands correctly
          ---
          duration_ms: 31.343458
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:596:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            1 !== 0
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 0
          actual: 1
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:601:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should maintain state consistency across script calls
        not ok 2 - should maintain state consistency across script calls
          ---
          duration_ms: 93.407125
          type: 'test'
          location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:618:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(listResult.stdout.includes('âœ… Active state-server1'))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:628:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..2
    not ok 8 - Integration with Real MCP Handler
      ---
      duration_ms: 124.8115
      type: 'suite'
      location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:594:3'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..8
not ok 19 - MCP Scripts Integration Tests
  ---
  duration_ms: 1684.309958
  type: 'suite'
  location: '/Users/rla/Projects/AUTOPM/test/migration/mcp-scripts.test.js:15:1'
  failureType: 'subtestsFailed'
  error: '7 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: PM Blocked Script Migration
    # Subtest: Node.js Implementation Tests (blocked.js)
        # Subtest: should export a function that returns blocked tasks data
        ok 1 - should export a function that returns blocked tasks data
          ---
          duration_ms: 3.655125
          type: 'test'
          ...
        # Subtest: should return structured data with blocked tasks
        ok 2 - should return structured data with blocked tasks
          ---
          duration_ms: 0.730125
          type: 'test'
          ...
        # Subtest: should find tasks blocked by dependencies
        ok 3 - should find tasks blocked by dependencies
          ---
          duration_ms: 3.607833
          type: 'test'
          ...
        # Subtest: should identify blocked tasks with open dependencies
        ok 4 - should identify blocked tasks with open dependencies
          ---
          duration_ms: 1.675667
          type: 'test'
          ...
        # Subtest: should parse dependencies from depends_on field
        ok 5 - should parse dependencies from depends_on field
          ---
          duration_ms: 1.884167
          type: 'test'
          ...
        # Subtest: should identify which dependencies are still open
        ok 6 - should identify which dependencies are still open
          ---
          duration_ms: 1.437459
          type: 'test'
          ...
        # Subtest: should skip tasks without dependencies
        ok 7 - should skip tasks without dependencies
          ---
          duration_ms: 1.742125
          type: 'test'
          ...
        # Subtest: should skip completed or closed tasks
        ok 8 - should skip completed or closed tasks
          ---
          duration_ms: 1.340042
          type: 'test'
          ...
        # Subtest: should handle malformed dependency syntax
        ok 9 - should handle malformed dependency syntax
          ---
          duration_ms: 1.816833
          type: 'test'
          ...
        # Subtest: should count total blocked tasks correctly
        ok 10 - should count total blocked tasks correctly
          ---
          duration_ms: 2.737458
          type: 'test'
          ...
        # Subtest: should handle dependencies referencing non-existent tasks
        ok 11 - should handle dependencies referencing non-existent tasks
          ---
          duration_ms: 1.285333
          type: 'test'
          ...
        1..11
    ok 1 - Node.js Implementation Tests (blocked.js)
      ---
      duration_ms: 23.675875
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle missing .claude/epics directory
        ok 1 - should handle missing .claude/epics directory
          ---
          duration_ms: 0.598459
          type: 'test'
          ...
        # Subtest: should handle empty epics directories
        ok 2 - should handle empty epics directories
          ---
          duration_ms: 1.400667
          type: 'test'
          ...
        # Subtest: should handle malformed task files
        ok 3 - should handle malformed task files
          ---
          duration_ms: 2.157834
          type: 'test'
          ...
        # Subtest: should handle various dependency formats
        ok 4 - should handle various dependency formats
          ---
          duration_ms: 2.114083
          type: 'test'
          ...
        1..4
    ok 2 - Edge Cases
      ---
      duration_ms: 6.420334
      type: 'suite'
      ...
    1..2
ok 20 - PM Blocked Script Migration
  ---
  duration_ms: 30.390417
  type: 'suite'
  ...
# Subtest: PM Epic List Script Migration
    # Subtest: Node.js Implementation Tests (epic-list.js)
        # Subtest: should export a function
        ok 1 - should export a function
          ---
          duration_ms: 2.264
          type: 'test'
          ...
        # Subtest: should return structured epic data
        ok 2 - should return structured epic data
          ---
          duration_ms: 4.480458
          type: 'test'
          ...
        # Subtest: should categorize epics by status correctly
        ok 3 - should categorize epics by status correctly
          ---
          duration_ms: 2.295208
          type: 'test'
          ...
        # Subtest: should handle various status formats
        ok 4 - should handle various status formats
          ---
          duration_ms: 10.708625
          type: 'test'
          ...
        # Subtest: should count tasks correctly
        ok 5 - should count tasks correctly
          ---
          duration_ms: 3.823375
          type: 'test'
          ...
        # Subtest: should extract GitHub issue numbers
        ok 6 - should extract GitHub issue numbers
          ---
          duration_ms: 1.754209
          type: 'test'
          ...
        # Subtest: should handle missing epic.md files
        ok 7 - should handle missing epic.md files
          ---
          duration_ms: 1.357333
          type: 'test'
          ...
        # Subtest: should provide default values for missing metadata
        ok 8 - should provide default values for missing metadata
          ---
          duration_ms: 1.711292
          type: 'test'
          ...
        # Subtest: should generate correct summary statistics
        ok 9 - should generate correct summary statistics
          ---
          duration_ms: 2.535292
          type: 'test'
          ...
        # Subtest: should handle empty epics directory
        ok 10 - should handle empty epics directory
          ---
          duration_ms: 0.926833
          type: 'test'
          ...
        # Subtest: should handle missing epics directory
        ok 11 - should handle missing epics directory
          ---
          duration_ms: 0.51225
          type: 'test'
          ...
        1..11
    ok 1 - Node.js Implementation Tests (epic-list.js)
      ---
      duration_ms: 33.170666
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should format output similar to bash version when used as CLI
        ok 1 - should format output similar to bash version when used as CLI
          ---
          duration_ms: 1.419084
          type: 'test'
          ...
        # Subtest: should include all required output sections
        ok 2 - should include all required output sections
          ---
          duration_ms: 2.075208
          type: 'test'
          ...
        1..2
    ok 2 - Output Format Tests
      ---
      duration_ms: 3.559875
      type: 'suite'
      ...
    # Subtest: Frontmatter Parsing Tests
        # Subtest: should parse YAML frontmatter correctly
        ok 1 - should parse YAML frontmatter correctly
          ---
          duration_ms: 2.240208
          type: 'test'
          ...
        # Subtest: should parse simple key-value frontmatter
        ok 2 - should parse simple key-value frontmatter
          ---
          duration_ms: 1.841875
          type: 'test'
          ...
        1..2
    ok 3 - Frontmatter Parsing Tests
      ---
      duration_ms: 4.149125
      type: 'suite'
      ...
    # Subtest: Error Handling Tests
        # Subtest: should handle corrupted epic.md files
        ok 1 - should handle corrupted epic.md files
          ---
          duration_ms: 1.560333
          type: 'test'
          ...
        # Subtest: should handle permission errors gracefully
        ok 2 - should handle permission errors gracefully
          ---
          duration_ms: 1.116083
          type: 'test'
          ...
        1..2
    ok 4 - Error Handling Tests
      ---
      duration_ms: 2.725375
      type: 'suite'
      ...
    # Subtest: Compatibility Tests
        # Subtest: should match bash script behavior for epic counting
        ok 1 - should match bash script behavior for epic counting
          ---
          duration_ms: 3.664958
          type: 'test'
          ...
        1..1
    ok 5 - Compatibility Tests
      ---
      duration_ms: 3.746334
      type: 'suite'
      ...
    1..5
ok 21 - PM Epic List Script Migration
  ---
  duration_ms: 47.663625
  type: 'suite'
  ...
# Subtest: PM Epic Show Script Migration
    # Subtest: Node.js Implementation Tests (epic-show.js)
        # Subtest: should export a function
        ok 1 - should export a function
          ---
          duration_ms: 2.442917
          type: 'test'
          ...
        # Subtest: should throw error for missing epic name parameter
        ok 2 - should throw error for missing epic name parameter
          ---
          duration_ms: 1.21175
          type: 'test'
          ...
        # Subtest: should return epic details for valid epic
        ok 3 - should return epic details for valid epic
          ---
          duration_ms: 2.397
          type: 'test'
          ...
        # Subtest: should parse epic metadata correctly
        ok 4 - should parse epic metadata correctly
          ---
          duration_ms: 1.540125
          type: 'test'
          ...
        # Subtest: should handle epic without metadata
        ok 5 - should handle epic without metadata
          ---
          duration_ms: 1.354
          type: 'test'
          ...
        # Subtest: should list and categorize tasks correctly
        ok 6 - should list and categorize tasks correctly
          ---
          duration_ms: 6.300792
          type: 'test'
          ...
        # Subtest: should calculate statistics correctly
        ok 7 - should calculate statistics correctly
          ---
          duration_ms: 5.30575
          type: 'test'
          ...
        # Subtest: should suggest appropriate actions
        ok 8 - should suggest appropriate actions
          ---
          duration_ms: 2.549541
          type: 'test'
          ...
        # Subtest: should suggest GitHub sync for epics with tasks but no GitHub link
        ok 9 - should suggest GitHub sync for epics with tasks but no GitHub link
          ---
          duration_ms: 4.658875
          type: 'test'
          ...
        # Subtest: should suggest starting work for epics with GitHub link
        ok 10 - should suggest starting work for epics with GitHub link
          ---
          duration_ms: 3.081334
          type: 'test'
          ...
        # Subtest: should handle epic not found error
        ok 11 - should handle epic not found error
          ---
          duration_ms: 0.532416
          type: 'test'
          ...
        # Subtest: should list available epics when epic not found
        ok 12 - should list available epics when epic not found
          ---
          duration_ms: 3.154667
          type: 'test'
          ...
        # Subtest: should handle empty tasks directory
        ok 13 - should handle empty tasks directory
          ---
          duration_ms: 1.900167
          type: 'test'
          ...
        # Subtest: should handle tasks without metadata
        ok 14 - should handle tasks without metadata
          ---
          duration_ms: 5.056875
          type: 'test'
          ...
        # Subtest: should parse YAML frontmatter in tasks
        ok 15 - should parse YAML frontmatter in tasks
          ---
          duration_ms: 4.321375
          type: 'test'
          ...
        1..15
    ok 1 - Node.js Implementation Tests (epic-show.js)
      ---
      duration_ms: 47.416208
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should format output similar to bash version when used as CLI
        ok 1 - should format output similar to bash version when used as CLI
          ---
          duration_ms: 7.9975
          type: 'test'
          ...
        # Subtest: should include all required output sections
        ok 2 - should include all required output sections
          ---
          duration_ms: 4.983833
          type: 'test'
          ...
        1..2
    ok 2 - Output Format Tests
      ---
      duration_ms: 13.133167
      type: 'suite'
      ...
    # Subtest: Error Handling Tests
        # Subtest: should handle corrupted epic.md files
        ok 1 - should handle corrupted epic.md files
          ---
          duration_ms: 4.888083
          type: 'test'
          ...
        # Subtest: should handle corrupted task files
        ok 2 - should handle corrupted task files
          ---
          duration_ms: 1.633708
          type: 'test'
          ...
        1..2
    ok 3 - Error Handling Tests
      ---
      duration_ms: 6.588209
      type: 'suite'
      ...
    # Subtest: Compatibility Tests
        # Subtest: should match bash script behavior for task status classification
        ok 1 - should match bash script behavior for task status classification
          ---
          duration_ms: 3.091291
          type: 'test'
          ...
        # Subtest: should match bash script action suggestions
        ok 2 - should match bash script action suggestions
          ---
          duration_ms: 9.154583
          type: 'test'
          ...
        1..2
    ok 4 - Compatibility Tests
      ---
      duration_ms: 12.313583
      type: 'suite'
      ...
    1..4
ok 22 - PM Epic Show Script Migration
  ---
  duration_ms: 80.653833
  type: 'suite'
  ...
# Subtest: PM Epic Status Script Migration
    # Subtest: Node.js Implementation Tests (epic-status.js)
        # Subtest: should export a function
        ok 1 - should export a function
          ---
          duration_ms: 2.287375
          type: 'test'
          ...
        # Subtest: should throw error for missing epic name parameter
        ok 2 - should throw error for missing epic name parameter
          ---
          duration_ms: 0.91975
          type: 'test'
          ...
        # Subtest: should return epic status data for valid epic
        ok 3 - should return epic status data for valid epic
          ---
          duration_ms: 7.613125
          type: 'test'
          ...
        # Subtest: should parse epic metadata correctly
        ok 4 - should parse epic metadata correctly
          ---
          duration_ms: 3.001959
          type: 'test'
          ...
        # Subtest: should calculate task breakdown correctly
        ok 5 - should calculate task breakdown correctly
          ---
          duration_ms: 7.811375
          type: 'test'
          ...
        # Subtest: should identify blocked tasks based on dependencies
        ok 6 - should identify blocked tasks based on dependencies
          ---
          duration_ms: 6.795625
          type: 'test'
          ...
        # Subtest: should generate progress bar correctly
        ok 7 - should generate progress bar correctly
          ---
          duration_ms: 15.904958
          type: 'test'
          ...
        # Subtest: should handle epic with no tasks
        ok 8 - should handle epic with no tasks
          ---
          duration_ms: 4.490417
          type: 'test'
          ...
        # Subtest: should handle epic not found error
        ok 9 - should handle epic not found error
          ---
          duration_ms: 1.152
          type: 'test'
          ...
        # Subtest: should list available epics when epic not found
        ok 10 - should list available epics when epic not found
          ---
          duration_ms: 4.043625
          type: 'test'
          ...
        # Subtest: should handle various dependency formats
        ok 11 - should handle various dependency formats
          ---
          duration_ms: 4.433459
          type: 'test'
          ...
        # Subtest: should handle tasks without metadata
        ok 12 - should handle tasks without metadata
          ---
          duration_ms: 4.9
          type: 'test'
          ...
        # Subtest: should calculate progress percentage correctly for edge cases
        ok 13 - should calculate progress percentage correctly for edge cases
          ---
          duration_ms: 5.073875
          type: 'test'
          ...
        # Subtest: should include GitHub link when available
        ok 14 - should include GitHub link when available
          ---
          duration_ms: 2.623792
          type: 'test'
          ...
        1..14
    ok 1 - Node.js Implementation Tests (epic-status.js)
      ---
      duration_ms: 73.059291
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should format output similar to bash version when used as CLI
        ok 1 - should format output similar to bash version when used as CLI
          ---
          duration_ms: 3.643375
          type: 'test'
          ...
        # Subtest: should include all required output sections
        ok 2 - should include all required output sections
          ---
          duration_ms: 2.307166
          type: 'test'
          ...
        # Subtest: should generate progress bar with correct format
        ok 3 - should generate progress bar with correct format
          ---
          duration_ms: 4.789417
          type: 'test'
          ...
        1..3
    ok 2 - Output Format Tests
      ---
      duration_ms: 10.850541
      type: 'suite'
      ...
    # Subtest: Error Handling Tests
        # Subtest: should handle corrupted epic.md files
        ok 1 - should handle corrupted epic.md files
          ---
          duration_ms: 2.754166
          type: 'test'
          ...
        # Subtest: should handle corrupted task files
        ok 2 - should handle corrupted task files
          ---
          duration_ms: 2.268125
          type: 'test'
          ...
        1..2
    ok 3 - Error Handling Tests
      ---
      duration_ms: 5.083
      type: 'suite'
      ...
    # Subtest: Compatibility Tests
        # Subtest: should match bash script behavior for dependency detection
        ok 1 - should match bash script behavior for dependency detection
          ---
          duration_ms: 5.577875
          type: 'test'
          ...
        # Subtest: should match bash script progress calculation
        ok 2 - should match bash script progress calculation
          ---
          duration_ms: 5.174708
          type: 'test'
          ...
        1..2
    ok 4 - Compatibility Tests
      ---
      duration_ms: 10.823291
      type: 'suite'
      ...
    1..4
ok 23 - PM Epic Status Script Migration
  ---
  duration_ms: 101.281625
  type: 'suite'
  ...
# bash: ../../autopm/.claude/scripts/pm/help.sh: No such file or directory
# Subtest: PM Help Script Migration
    # Subtest: Node.js Implementation Tests (help.js)
        # Subtest: should export a function that returns help content
        ok 1 - should export a function that returns help content
          ---
          duration_ms: 2.828625
          type: 'test'
          ...
        # Subtest: should return help content as string
        ok 2 - should return help content as string
          ---
          duration_ms: 0.826458
          type: 'test'
          ...
        # Subtest: should include main sections in help content
        ok 3 - should include main sections in help content
          ---
          duration_ms: 2.011291
          type: 'test'
          ...
        # Subtest: should include specific commands in help content
        ok 4 - should include specific commands in help content
          ---
          duration_ms: 0.53
          type: 'test'
          ...
        # Subtest: should include usage tips
        ok 5 - should include usage tips
          ---
          duration_ms: 0.828291
          type: 'test'
          ...
        1..5
    ok 1 - Node.js Implementation Tests (help.js)
      ---
      duration_ms: 7.596
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should match bash script output format
        ok 1 - should match bash script output format
          ---
          duration_ms: 1.291208
          type: 'test'
          ...
        # Subtest: should include workflow numbers
        ok 2 - should include workflow numbers
          ---
          duration_ms: 2.74575
          type: 'test'
          ...
        1..2
    ok 2 - Output Format Tests
      ---
      duration_ms: 4.332375
      type: 'suite'
      ...
    # Subtest: Backward Compatibility Tests
        # Subtest: should execute bash wrapper successfully
        ok 1 - should execute bash wrapper successfully
          ---
          duration_ms: 16.998083
          type: 'test'
          ...
        1..1
    ok 3 - Backward Compatibility Tests
      ---
      duration_ms: 17.068209
      type: 'suite'
      ...
    1..3
ok 24 - PM Help Script Migration
  ---
  duration_ms: 29.952333
  type: 'suite'
  ...
# Subtest: PM In-Progress Script Migration
    # Subtest: Node.js Implementation Tests (in-progress.js)
        # Subtest: should export a function that returns in-progress data
        ok 1 - should export a function that returns in-progress data
          ---
          duration_ms: 2.870875
          type: 'test'
          ...
        # Subtest: should return structured data with active work items
        ok 2 - should return structured data with active work items
          ---
          duration_ms: 0.538583
          type: 'test'
          ...
        # Subtest: should find active work items in updates directories
        ok 3 - should find active work items in updates directories
          ---
          duration_ms: 6.711583
          type: 'test'
          ...
        # Subtest: should find active epics with in-progress status
        ok 4 - should find active epics with in-progress status
          ---
          duration_ms: 2.071625
          type: 'test'
          ...
        # Subtest: should handle epics with active status
        ok 5 - should handle epics with active status
          ---
          duration_ms: 2.415209
          type: 'test'
          ...
        # Subtest: should extract task names from task files
        ok 6 - should extract task names from task files
          ---
          duration_ms: 5.988
          type: 'test'
          ...
        # Subtest: should default to "Unknown task" when task file missing
        ok 7 - should default to "Unknown task" when task file missing
          ---
          duration_ms: 4.85875
          type: 'test'
          ...
        # Subtest: should default completion to 0% when not specified
        ok 8 - should default completion to 0% when not specified
          ---
          duration_ms: 3.731709
          type: 'test'
          ...
        # Subtest: should handle epics without explicit progress
        ok 9 - should handle epics without explicit progress
          ---
          duration_ms: 5.6975
          type: 'test'
          ...
        # Subtest: should count total active items correctly
        ok 10 - should count total active items correctly
          ---
          duration_ms: 15.845417
          type: 'test'
          ...
        1..10
    ok 1 - Node.js Implementation Tests (in-progress.js)
      ---
      duration_ms: 51.366083
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle missing .claude/epics directory
        ok 1 - should handle missing .claude/epics directory
          ---
          duration_ms: 0.470792
          type: 'test'
          ...
        # Subtest: should handle epics without epic.md files
        ok 2 - should handle epics without epic.md files
          ---
          duration_ms: 2.644333
          type: 'test'
          ...
        # Subtest: should handle malformed progress files
        ok 3 - should handle malformed progress files
          ---
          duration_ms: 6.4285
          type: 'test'
          ...
        # Subtest: should skip epics with completed or closed status
        ok 4 - should skip epics with completed or closed status
          ---
          duration_ms: 5.318166
          type: 'test'
          ...
        1..4
    ok 2 - Edge Cases
      ---
      duration_ms: 15.085834
      type: 'suite'
      ...
    1..2
ok 25 - PM In-Progress Script Migration
  ---
  duration_ms: 66.734333
  type: 'suite'
  ...
# Subtest: PM Init Script Migration
    # Subtest: Node.js Implementation Tests (init.js)
        # Subtest: should export a function that returns initialization result
        ok 1 - should export a function that returns initialization result
          ---
          duration_ms: 3.916208
          type: 'test'
          ...
        # Subtest: should return structured data about initialization
        ok 2 - should return structured data about initialization
          ---
          duration_ms: 436.604625
          type: 'test'
          ...
        # Subtest: should check for required directories
        ok 3 - should check for required directories
          ---
          duration_ms: 373.928292
          type: 'test'
          ...
        # Subtest: should create missing directories in non-dry-run mode
        ok 4 - should create missing directories in non-dry-run mode
          ---
          duration_ms: 670.502125
          type: 'test'
          ...
        # Subtest: should check git repository status
        ok 5 - should check git repository status
          ---
          duration_ms: 411.287708
          type: 'test'
          ...
        # Subtest: should detect git repository when present
        ok 6 - should detect git repository when present
          ---
          duration_ms: 376.0495
          type: 'test'
          ...
        # Subtest: should check dependency tools availability
        ok 7 - should check dependency tools availability
          ---
          duration_ms: 385.585375
          type: 'test'
          ...
        # Subtest: should create CLAUDE.md if missing
        ok 8 - should create CLAUDE.md if missing
          ---
          duration_ms: 423.703083
          type: 'test'
          ...
        # Subtest: should not overwrite existing CLAUDE.md
        ok 9 - should not overwrite existing CLAUDE.md
          ---
          duration_ms: 554.312125
          type: 'test'
          ...
        # Subtest: should handle template repository warning
        ok 10 - should handle template repository warning
          ---
          duration_ms: 365.25225
          type: 'test'
          ...
        # Subtest: should support dry run mode
        ok 11 - should support dry run mode
          ---
          duration_ms: 391.867875
          type: 'test'
          ...
        # Subtest: should support options parameter
        ok 12 - should support options parameter
          ---
          duration_ms: 15.090417
          type: 'test'
          ...
        1..12
    ok 1 - Node.js Implementation Tests (init.js)
      ---
      duration_ms: 4409.012917
      type: 'suite'
      ...
    # Subtest: Integration Tests
        # Subtest: should handle missing gh CLI gracefully
        ok 1 - should handle missing gh CLI gracefully
          ---
          duration_ms: 379.327583
          type: 'test'
          ...
        # Subtest: should provide helpful status summary
        ok 2 - should provide helpful status summary
          ---
          duration_ms: 393.244459
          type: 'test'
          ...
        1..2
    ok 2 - Integration Tests
      ---
      duration_ms: 772.665958
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle permission errors gracefully
        ok 1 - should handle permission errors gracefully
          ---
          duration_ms: 379.093334
          type: 'test'
          ...
        # Subtest: should handle already initialized projects
        ok 2 - should handle already initialized projects
          ---
          duration_ms: 377.853041
          type: 'test'
          ...
        1..2
    ok 3 - Edge Cases
      ---
      duration_ms: 757.021625
      type: 'suite'
      ...
    # Subtest: CLI Integration
        # Subtest: should work as CLI script
        ok 1 - should work as CLI script
          ---
          duration_ms: 0.339292
          type: 'test'
          ...
        1..1
    ok 4 - CLI Integration
      ---
      duration_ms: 0.3755
      type: 'suite'
      ...
    1..4
ok 26 - PM Init Script Migration
  ---
  duration_ms: 5939.449334
  type: 'suite'
  ...
# Subtest: PM Next Script Migration
    # Subtest: Node.js Implementation Tests (next.js)
        # Subtest: should export a function that returns next tasks data
        ok 1 - should export a function that returns next tasks data
          ---
          duration_ms: 4.114458
          type: 'test'
          ...
        # Subtest: should return structured data with available tasks
        ok 2 - should return structured data with available tasks
          ---
          duration_ms: 3.341875
          type: 'test'
          ...
        # Subtest: should find tasks with no dependencies
        ok 3 - should find tasks with no dependencies
          ---
          duration_ms: 5.116458
          type: 'test'
          ...
        # Subtest: should exclude tasks with unresolved dependencies
        ok 4 - should exclude tasks with unresolved dependencies
          ---
          duration_ms: 4.599542
          type: 'test'
          ...
        # Subtest: should exclude non-open tasks
        ok 5 - should exclude non-open tasks
          ---
          duration_ms: 5.730834
          type: 'test'
          ...
        # Subtest: should include task details like name, number, epic, and parallel flag
        ok 6 - should include task details like name, number, epic, and parallel flag
          ---
          duration_ms: 8.679167
          type: 'test'
          ...
        # Subtest: should handle empty project structure gracefully
        ok 7 - should handle empty project structure gracefully
          ---
          duration_ms: 1.456166
          type: 'test'
          ...
        # Subtest: should provide suggestions when no tasks are available
        ok 8 - should provide suggestions when no tasks are available
          ---
          duration_ms: 7.808917
          type: 'test'
          ...
        # Subtest: should include display messages array with proper formatting
        ok 9 - should include display messages array with proper formatting
          ---
          duration_ms: 1.163959
          type: 'test'
          ...
        # Subtest: should match exact output format of bash script when run as CLI
        ok 10 - should match exact output format of bash script when run as CLI
          ---
          duration_ms: 42.992375
          type: 'test'
          ...
        1..10
    ok 1 - Node.js Implementation Tests (next.js)
      ---
      duration_ms: 85.782041
      type: 'suite'
      ...
    # Subtest: Backward Compatibility Tests
        # Subtest: should maintain bash script functionality
        ok 1 - should maintain bash script functionality
          ---
          duration_ms: 50.425542
          type: 'test'
          ...
        # Subtest: bash and Node.js outputs should be identical for same project structure
        ok 2 - bash and Node.js outputs should be identical for same project structure
          ---
          duration_ms: 68.7435
          type: 'test'
          ...
        1..2
    ok 2 - Backward Compatibility Tests
      ---
      duration_ms: 119.249875
      type: 'suite'
      ...
    # Subtest: Dependency Resolution Tests
        # Subtest: should handle complex dependency chains correctly
        ok 1 - should handle complex dependency chains correctly
          ---
          duration_ms: 1.367916
          type: 'test'
          ...
        # Subtest: should handle multiple dependencies correctly
        ok 2 - should handle multiple dependencies correctly
          ---
          duration_ms: 1.63175
          type: 'test'
          ...
        # Subtest: should work across multiple epics
        ok 3 - should work across multiple epics
          ---
          duration_ms: 1.131542
          type: 'test'
          ...
        1..3
    ok 3 - Dependency Resolution Tests
      ---
      duration_ms: 4.200584
      type: 'suite'
      ...
    # Subtest: Performance and Reliability Tests
        # Subtest: should handle large number of tasks efficiently
        ok 1 - should handle large number of tasks efficiently
          ---
          duration_ms: 36.447042
          type: 'test'
          ...
        # Subtest: should handle filesystem permission errors gracefully
        ok 2 - should handle filesystem permission errors gracefully
          ---
          duration_ms: 0.452333
          type: 'test'
          ...
        1..2
    ok 4 - Performance and Reliability Tests
      ---
      duration_ms: 36.981709
      type: 'suite'
      ...
    1..4
ok 27 - PM Next Script Migration
  ---
  duration_ms: 246.527958
  type: 'suite'
  ...
# Subtest: PM PRD List Script Migration
    # Subtest: Node.js Implementation Tests (prd-list.js)
        # Subtest: should export a function
        ok 1 - should export a function
          ---
          duration_ms: 1.992625
          type: 'test'
          ...
        # Subtest: should return structured PRD data
        ok 2 - should return structured PRD data
          ---
          duration_ms: 8.567667
          type: 'test'
          ...
        # Subtest: should categorize PRDs by status correctly
        ok 3 - should categorize PRDs by status correctly
          ---
          duration_ms: 10.5575
          type: 'test'
          ...
        # Subtest: should handle PRDs without status (default to backlog)
        ok 4 - should handle PRDs without status (default to backlog)
          ---
          duration_ms: 4.950666
          type: 'test'
          ...
        # Subtest: should extract metadata correctly
        ok 5 - should extract metadata correctly
          ---
          duration_ms: 4.53625
          type: 'test'
          ...
        # Subtest: should handle PRDs without description
        ok 6 - should handle PRDs without description
          ---
          duration_ms: 5.043458
          type: 'test'
          ...
        # Subtest: should use filename as fallback for name
        ok 7 - should use filename as fallback for name
          ---
          duration_ms: 2.310209
          type: 'test'
          ...
        # Subtest: should generate correct summary statistics
        ok 8 - should generate correct summary statistics
          ---
          duration_ms: 3.410416
          type: 'test'
          ...
        # Subtest: should handle empty PRDs directory
        ok 9 - should handle empty PRDs directory
          ---
          duration_ms: 3.46825
          type: 'test'
          ...
        # Subtest: should handle missing PRDs directory
        ok 10 - should handle missing PRDs directory
          ---
          duration_ms: 0.491708
          type: 'test'
          ...
        # Subtest: should only process .md files
        ok 11 - should only process .md files
          ---
          duration_ms: 3.527
          type: 'test'
          ...
        # Subtest: should handle YAML frontmatter
        ok 12 - should handle YAML frontmatter
          ---
          duration_ms: 2.999625
          type: 'test'
          ...
        # Subtest: should handle simple key-value frontmatter
        ok 13 - should handle simple key-value frontmatter
          ---
          duration_ms: 2.285833
          type: 'test'
          ...
        1..13
    ok 1 - Node.js Implementation Tests (prd-list.js)
      ---
      duration_ms: 55.086833
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should format output similar to bash version when used as CLI
        ok 1 - should format output similar to bash version when used as CLI
          ---
          duration_ms: 2.296916
          type: 'test'
          ...
        # Subtest: should include all required output sections
        ok 2 - should include all required output sections
          ---
          duration_ms: 1.11175
          type: 'test'
          ...
        1..2
    ok 2 - Output Format Tests
      ---
      duration_ms: 3.479667
      type: 'suite'
      ...
    # Subtest: Status Mapping Tests
        # Subtest: should map all status variations correctly
        ok 1 - should map all status variations correctly
          ---
          duration_ms: 7.251083
          type: 'test'
          ...
        1..1
    ok 3 - Status Mapping Tests
      ---
      duration_ms: 7.295166
      type: 'suite'
      ...
    # Subtest: Error Handling Tests
        # Subtest: should handle corrupted PRD files
        ok 1 - should handle corrupted PRD files
          ---
          duration_ms: 3.313958
          type: 'test'
          ...
        # Subtest: should handle permission errors gracefully
        ok 2 - should handle permission errors gracefully
          ---
          duration_ms: 1.794958
          type: 'test'
          ...
        1..2
    ok 4 - Error Handling Tests
      ---
      duration_ms: 5.169833
      type: 'suite'
      ...
    # Subtest: Compatibility Tests
        # Subtest: should match bash script behavior for file processing
        ok 1 - should match bash script behavior for file processing
          ---
          duration_ms: 1.441
          type: 'test'
          ...
        # Subtest: should handle missing directory same as bash script
        ok 2 - should handle missing directory same as bash script
          ---
          duration_ms: 0.360667
          type: 'test'
          ...
        # Subtest: should handle empty directory same as bash script
        ok 3 - should handle empty directory same as bash script
          ---
          duration_ms: 1.157125
          type: 'test'
          ...
        1..3
    ok 5 - Compatibility Tests
      ---
      duration_ms: 3.026209
      type: 'suite'
      ...
    1..5
ok 28 - PM PRD List Script Migration
  ---
  duration_ms: 75.311917
  type: 'suite'
  ...
# Subtest: PM Search Script Migration
    # Subtest: Node.js Implementation Tests (search.js)
        # Subtest: should export a function that accepts query parameter
        ok 1 - should export a function that accepts query parameter
          ---
          duration_ms: 2.97625
          type: 'test'
          ...
        # Subtest: should throw error for missing query parameter
        ok 2 - should throw error for missing query parameter
          ---
          duration_ms: 1.266833
          type: 'test'
          ...
        # Subtest: should return search results object with sections
        ok 3 - should return search results object with sections
          ---
          duration_ms: 9.01525
          type: 'test'
          ...
        # Subtest: should find matches in PRDs
        ok 4 - should find matches in PRDs
          ---
          duration_ms: 5.453583
          type: 'test'
          ...
        # Subtest: should find matches in epics
        ok 5 - should find matches in epics
          ---
          duration_ms: 6.712208
          type: 'test'
          ...
        # Subtest: should find matches in tasks
        ok 6 - should find matches in tasks
          ---
          duration_ms: 4.31875
          type: 'test'
          ...
        # Subtest: should handle case insensitive search
        ok 7 - should handle case insensitive search
          ---
          duration_ms: 2.6595
          type: 'test'
          ...
        # Subtest: should limit task results
        ok 8 - should limit task results
          ---
          duration_ms: 12.436875
          type: 'test'
          ...
        # Subtest: should return zero total when no matches found
        ok 9 - should return zero total when no matches found
          ---
          duration_ms: 2.289166
          type: 'test'
          ...
        1..9
    ok 1 - Node.js Implementation Tests (search.js)
      ---
      duration_ms: 47.885
      type: 'suite'
      ...
    # Subtest: Output Format Tests
        # Subtest: should return formatted string when used as CLI
        ok 1 - should return formatted string when used as CLI
          ---
          duration_ms: 2.105292
          type: 'test'
          ...
        1..1
    ok 2 - Output Format Tests
      ---
      duration_ms: 2.158833
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle missing directories gracefully
        ok 1 - should handle missing directories gracefully
          ---
          duration_ms: 1.392875
          type: 'test'
          ...
        # Subtest: should handle empty directories
        ok 2 - should handle empty directories
          ---
          duration_ms: 2.662792
          type: 'test'
          ...
        # Subtest: should handle files without proper content
        ok 3 - should handle files without proper content
          ---
          duration_ms: 2.543708
          type: 'test'
          ...
        1..3
    ok 3 - Edge Cases
      ---
      duration_ms: 6.6965
      type: 'suite'
      ...
    1..3
ok 29 - PM Search Script Migration
  ---
  duration_ms: 57.029
  type: 'suite'
  ...
# Subtest: PM Standup Script Migration
    # Subtest: Node.js Implementation Tests (standup.js)
        # Subtest: should export a function that returns standup data
        ok 1 - should export a function that returns standup data
          ---
          duration_ms: 3.517375
          type: 'test'
          ...
        # Subtest: should return structured data with date and activity counts
        ok 2 - should return structured data with date and activity counts
          ---
          duration_ms: 9.217334
          type: 'test'
          ...
        # Subtest: should detect files modified today
        ok 3 - should detect files modified today
          ---
          duration_ms: 7.344792
          type: 'test'
          ...
        # Subtest: should find tasks in progress with completion percentages
        ok 4 - should find tasks in progress with completion percentages
          ---
          duration_ms: 3.96425
          type: 'test'
          ...
        # Subtest: should find next available tasks without dependencies
        ok 5 - should find next available tasks without dependencies
          ---
          duration_ms: 7.71625
          type: 'test'
          ...
        # Subtest: should include formatted date in today's format
        ok 6 - should include formatted date in today's format
          ---
          duration_ms: 0.581541
          type: 'test'
          ...
        # Subtest: should handle empty project structure gracefully
        ok 7 - should handle empty project structure gracefully
          ---
          duration_ms: 0.732292
          type: 'test'
          ...
        # Subtest: should include display messages array with proper formatting
        ok 8 - should include display messages array with proper formatting
          ---
          duration_ms: 0.569583
          type: 'test'
          ...
        # Subtest: should match exact output format of bash script when run as CLI
        ok 9 - should match exact output format of bash script when run as CLI
          ---
          duration_ms: 38.9
          type: 'test'
          ...
        1..9
    ok 1 - Node.js Implementation Tests (standup.js)
      ---
      duration_ms: 73.330209
      type: 'suite'
      ...
    # Subtest: Backward Compatibility Tests
        # Subtest: should maintain bash script functionality
        ok 1 - should maintain bash script functionality
          ---
          duration_ms: 44.05275
          type: 'test'
          ...
        # Subtest: bash and Node.js outputs should be identical for same project structure
        ok 2 - bash and Node.js outputs should be identical for same project structure
          ---
          duration_ms: 70.290541
          type: 'test'
          ...
        1..2
    ok 2 - Backward Compatibility Tests
      ---
      duration_ms: 114.4315
      type: 'suite'
      ...
    # Subtest: File Processing and Date Handling Tests
        # Subtest: should correctly count file modifications by type
        ok 1 - should correctly count file modifications by type
          ---
          duration_ms: 4.04675
          type: 'test'
          ...
        # Subtest: should handle tasks with parallel flag
        ok 2 - should handle tasks with parallel flag
          ---
          duration_ms: 1.566625
          type: 'test'
          ...
        # Subtest: should provide accurate quick statistics
        ok 3 - should provide accurate quick statistics
          ---
          duration_ms: 1.721209
          type: 'test'
          ...
        1..3
    ok 3 - File Processing and Date Handling Tests
      ---
      duration_ms: 7.411292
      type: 'suite'
      ...
    # Subtest: Performance and Reliability Tests
        # Subtest: should handle large number of files efficiently
        ok 1 - should handle large number of files efficiently
          ---
          duration_ms: 104.255625
          type: 'test'
          ...
        # Subtest: should handle filesystem permission errors gracefully
        ok 2 - should handle filesystem permission errors gracefully
          ---
          duration_ms: 0.480042
          type: 'test'
          ...
        1..2
    ok 4 - Performance and Reliability Tests
      ---
      duration_ms: 104.794458
      type: 'suite'
      ...
    1..4
ok 30 - PM Standup Script Migration
  ---
  duration_ms: 300.274667
  type: 'suite'
  ...
# Subtest: PM Status Script Migration
    # Subtest: Node.js Implementation Tests (status.js)
        # Subtest: should export a function that returns status data
        ok 1 - should export a function that returns status data
          ---
          duration_ms: 2.998125
          type: 'test'
          ...
        # Subtest: should return structured data with PRDs count
        ok 2 - should return structured data with PRDs count
          ---
          duration_ms: 2.570916
          type: 'test'
          ...
        # Subtest: should return structured data with epics count
        ok 3 - should return structured data with epics count
          ---
          duration_ms: 3.427709
          type: 'test'
          ...
        # Subtest: should return structured data with tasks count and status breakdown
        ok 4 - should return structured data with tasks count and status breakdown
          ---
          duration_ms: 5.990042
          type: 'test'
          ...
        # Subtest: should handle empty project structure
        ok 5 - should handle empty project structure
          ---
          duration_ms: 0.599708
          type: 'test'
          ...
        # Subtest: should include display messages array
        ok 6 - should include display messages array
          ---
          duration_ms: 0.333583
          type: 'test'
          ...
        # Subtest: should match exact output format of bash script when run as CLI
        ok 7 - should match exact output format of bash script when run as CLI
          ---
          duration_ms: 38.737292
          type: 'test'
          ...
        1..7
    ok 1 - Node.js Implementation Tests (status.js)
      ---
      duration_ms: 55.285
      type: 'suite'
      ...
    # Subtest: Backward Compatibility Tests
        # Subtest: should maintain bash script functionality
        ok 1 - should maintain bash script functionality
          ---
          duration_ms: 37.104167
          type: 'test'
          ...
        # Subtest: bash and Node.js outputs should be identical for same project structure
        ok 2 - bash and Node.js outputs should be identical for same project structure
          ---
          duration_ms: 65.454125
          type: 'test'
          ...
        1..2
    ok 2 - Backward Compatibility Tests
      ---
      duration_ms: 102.748833
      type: 'suite'
      ...
    # Subtest: Performance and Reliability Tests
        # Subtest: should handle large number of files efficiently
        ok 1 - should handle large number of files efficiently
          ---
          duration_ms: 189.32075
          type: 'test'
          ...
        # Subtest: should handle filesystem permission errors gracefully
        ok 2 - should handle filesystem permission errors gracefully
          ---
          duration_ms: 0.355459
          type: 'test'
          ...
        1..2
    ok 3 - Performance and Reliability Tests
      ---
      duration_ms: 189.739458
      type: 'suite'
      ...
    1..3
ok 31 - PM Status Script Migration
  ---
  duration_ms: 348.262333
  type: 'suite'
  ...
# Subtest: PM Validation Script Migration
    # Subtest: should detect missing .claude directory
    ok 1 - should detect missing .claude directory
      ---
      duration_ms: 1.695708
      type: 'test'
      ...
    # Subtest: should validate complete directory structure
    ok 2 - should validate complete directory structure
      ---
      duration_ms: 1.286708
      type: 'test'
      ...
    # Subtest: should detect missing epic.md files
    ok 3 - should detect missing epic.md files
      ---
      duration_ms: 1.345666
      type: 'test'
      ...
    # Subtest: should detect orphaned task files
    ok 4 - should detect orphaned task files
      ---
      duration_ms: 1.033667
      type: 'test'
      ...
    # Subtest: should detect broken task dependencies
    ok 5 - should detect broken task dependencies
      ---
      duration_ms: 1.259083
      type: 'test'
      ...
    # Subtest: should detect missing frontmatter
    ok 6 - should detect missing frontmatter
      ---
      duration_ms: 1.465417
      type: 'test'
      ...
    # Subtest: should show healthy system when no issues
    ok 7 - should show healthy system when no issues
      ---
      duration_ms: 2.249583
      type: 'test'
      ...
    # Subtest: should include all required section headers
    ok 8 - should include all required section headers
      ---
      duration_ms: 0.546041
      type: 'test'
      ...
    # Subtest: should export function using CommonJS
    ok 9 - should export function using CommonJS
      ---
      duration_ms: 0.427459
      type: 'test'
      ...
    # Subtest: should return structured result
    ok 10 - should return structured result
      ---
      duration_ms: 0.399333
      type: 'test'
      ...
    1..10
ok 32 - PM Validation Script Migration
  ---
  duration_ms: 12.487583
  type: 'suite'
  ...
1..32
# tests 328
# suites 109
# pass 300
# fail 28
# cancelled 0
# skipped 0
# todo 0
# duration_ms 11513.59575
