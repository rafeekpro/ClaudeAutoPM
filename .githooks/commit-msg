#!/bin/bash

# Git hook to remove AI assistants from commit messages
# This ensures Claude, Copilot, and other AI tools are never listed as contributors

# Read the commit message
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Remove AI co-authors from the commit message
CLEANED_MSG=$(echo "$COMMIT_MSG" | sed \
    -e '/Co-[Aa]uthored-[Bb]y:.*[Cc]laude/d' \
    -e '/Co-[Aa]uthored-[Bb]y:.*[Cc]opilot/d' \
    -e '/Co-[Aa]uthored-[Bb]y:.*anthropic/d' \
    -e '/Co-[Aa]uthored-[Bb]y:.*github-actions/d' \
    -e '/Co-[Aa]uthored-[Bb]y:.*\[bot\]/d' \
    -e '/Generated with.*Claude/d' \
    -e '/Generated by.*Copilot/d' \
    -e '/ðŸ¤–.*Generated/d')

# Write the cleaned message back
echo "$CLEANED_MSG" > "$COMMIT_MSG_FILE"

# Log what was removed (optional, for debugging)
if [ "$COMMIT_MSG" != "$CLEANED_MSG" ]; then
    echo "âœ… Removed AI assistant attribution from commit message"
fi

exit 0